jQuery(document).ready(function($){"use strict";if("undefined"!=typeof houzezProperty){var dtGlobals={};dtGlobals.isMobile=/(Android|BlackBerry|iPhone|iPad|Palm|Symbian|Opera Mini|IEMobile|webOS)/.test(navigator.userAgent),dtGlobals.isAndroid=/(Android)/.test(navigator.userAgent),dtGlobals.isiOS=/(iPhone|iPod|iPad)/.test(navigator.userAgent),dtGlobals.isiPhone=/(iPhone|iPod)/.test(navigator.userAgent),dtGlobals.isiPad=/(iPad|iPod)/.test(navigator.userAgent);var ajax_url=houzezProperty.ajaxURL,is_edit_property=houzezProperty.is_edit_property,houzez_logged_in=houzezProperty.houzez_logged_in,login_sending=houzezProperty.login_loading,process_loader_refresh=houzezProperty.process_loader_refresh,process_loader_spinner=houzezProperty.process_loader_spinner,process_loader_circle=houzezProperty.process_loader_circle,process_loader_cog=houzezProperty.process_loader_cog,success_icon=houzezProperty.success_icon,verify_nonce=houzezProperty.verify_nonce,verify_file_type=houzezProperty.verify_file_type,msg_digits=houzezProperty.msg_digits,max_prop_images=houzezProperty.max_prop_images,image_max_file_size=houzezProperty.image_max_file_size,max_prop_attachments=houzezProperty.max_prop_attachments,attachment_max_file_size=houzezProperty.attachment_max_file_size,add_listing_msg=houzezProperty.add_listing_msg,processing_text=houzezProperty.processing_text,plan_title_text=houzezProperty.plan_title_text,plan_size_text=houzezProperty.plan_size_text,plan_bedrooms_text=houzezProperty.plan_bedrooms_text,plan_bathrooms_text=houzezProperty.plan_bathrooms_text,plan_price_text=houzezProperty.plan_price_text,plan_price_postfix_text=houzezProperty.plan_price_postfix_text,plan_image_text=houzezProperty.plan_image_text,plan_description_text=houzezProperty.plan_description_text,plan_upload_text=houzezProperty.plan_upload_text,mu_title_text=houzezProperty.mu_title_text,mu_type_text=houzezProperty.mu_type_text,mu_beds_text=houzezProperty.mu_beds_text,mu_baths_text=houzezProperty.mu_baths_text,mu_size_text=houzezProperty.mu_size_text,mu_size_postfix_text=houzezProperty.mu_size_postfix_text,mu_price_text=houzezProperty.mu_price_text,mu_price_postfix_text=houzezProperty.mu_price_postfix_text,mu_availability_text=houzezProperty.mu_availability_text,are_you_sure_text=houzezProperty.are_you_sure_text,delete_btn_text=houzezProperty.delete_btn_text,cancel_btn_text=houzezProperty.cancel_btn_text,confirm_btn_text=houzezProperty.confirm_btn_text,prop_title=houzezProperty.prop_title,prop_price=houzezProperty.prop_price,prop_sec_price=houzezProperty.prop_sec_price,prop_type=houzezProperty.prop_type,prop_status=houzezProperty.prop_status,prop_labels=houzezProperty.prop_labels,price_label=houzezProperty.price_label,prop_id=houzezProperty.prop_id,bedrooms=houzezProperty.bedrooms,bathrooms=houzezProperty.bathrooms,area_size=houzezProperty.area_size,land_area=houzezProperty.land_area,garages=houzezProperty.garages,year_built=houzezProperty.year_built,property_map_address=houzezProperty.property_map_address,neighborhood=houzezProperty.neighborhood,city=houzezProperty.city,state=houzezProperty.state,country=houzezProperty.country,enable_title_limit=houzezProperty.enable_title_limit,property_title_limit=houzezProperty.property_title_limit,houzez_processing_modal=function(e){document.getElementById("fave_modal")&&document.getElementById("fave_modal").remove();var t='<div class="modal fade" id="fave_modal" tabindex="-1" aria-labelledby="faveModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body houzez_messages_modal">'+e+"</div></div></div></div>";jQuery("body").append(t),new bootstrap.Modal(document.getElementById("fave_modal")).show()},houzez_processing_modal_close=function(){var e=document.getElementById("fave_modal");if(e){var t=bootstrap.Modal.getInstance(e);t?(e.addEventListener("hidden.bs.modal",function t(){jQuery(e).remove(),e.removeEventListener("hidden.bs.modal",t)}),t.hide()):jQuery(e).remove()}};function togglePricePlaceholder(){$("#show_price_placeholder").is(":checked")?$("#price-plac-js").show():$("#price-plac-js").hide()}$("#show_price_placeholder").change(togglePricePlaceholder),togglePricePlaceholder(),$("#property-author-js").on("change",function(){var e=$(this).val();$('input[name="property_author"]').val(e)}),$("#property-author-mobile-js").on("change",function(){var e=$(this).val();$('input[name="property_author"]').val(e)}),$(".houzez-prop-action-js").on("click",function(e){e.preventDefault();var t=$(this),a=t.attr("data-propid"),o=t.attr("data-type");bootbox.confirm({message:"<strong>"+are_you_sure_text+"</strong>",closeButton:!1,buttons:{confirm:{label:confirm_btn_text,className:"btn btn-primary"},cancel:{label:cancel_btn_text,className:"btn btn-grey-outlined"}},callback:function(e){1==e&&(houzez_processing_modal(processing_text),houzez_property_actions(a,t,o),t.unbind("click"))}})});var houzez_property_actions=function(prop_id,currentDiv,type){var $messages=$("#houzez_messages");$.ajax({type:"POST",url:ajax_url,dataType:"JSON",data:{action:"houzez_property_actions",propid:prop_id,type:type},success:function(e){e.success?window.location.reload():(houzez_processing_modal_close(),$("html, body").animate({scrollTop:$(".dashboard-content").offset().top},"slow"),$messages.empty().append('<div class="alert alert-danger alert-dismissible fade show" role="alert">'+houzezProperty.featured_listings_none+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'))},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}})};$(".make-prop-featured").on("click",function(e){e.preventDefault();var t=$(this),a=t.attr("data-propid"),o=t.attr("data-proptype");bootbox.confirm({message:"<strong>"+houzezProperty.confirm_featured+"</strong>",closeButton:!1,buttons:{confirm:{label:confirm_btn_text,className:"btn btn-primary"},cancel:{label:cancel_btn_text,className:"btn btn-grey-outlined"}},callback:function(e){1==e&&(houzez_processing_modal(processing_text),make_prop_featured(a,t,o),t.unbind("click"))}})});var make_prop_featured=function(prop_id,currentDiv,prop_type){var $messages=$("#houzez_messages");$.ajax({type:"POST",url:ajax_url,dataType:"JSON",data:{action:"houzez_make_prop_featured",propid:prop_id,prop_type:prop_type},success:function(e){e.success?window.location.reload():(houzez_processing_modal_close(),$("html, body").animate({scrollTop:$(".dashboard-content").offset().top},"slow"),$messages.empty().append('<div class="alert alert-danger alert-dismissible fade show mt-3" role="alert">'+houzezProperty.featured_listings_none+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>'))},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}})};$(".remove-prop-featured").click(function(e){e.preventDefault();var t=$(this),a=t.attr("data-propid");bootbox.confirm({message:"<strong>"+houzezProperty.confirm_featured_remove+"</strong>",closeButton:!1,buttons:{confirm:{label:confirm_btn_text,className:"btn btn-primary"},cancel:{label:cancel_btn_text,className:"btn btn-grey-outlined"}},callback:function(e){1==e&&(houzez_processing_modal(processing_text),remove_prop_featured(a,t),$(this).unbind("click"))}})});var remove_prop_featured=function(prop_id,currentDiv){$.ajax({type:"POST",url:ajax_url,dataType:"JSON",data:{action:"houzez_remove_prop_featured",propid:prop_id},success:function(e){e.success&&window.location.reload()},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}})};$(".resend-for-approval").click(function(e){e.preventDefault();var t=$(this).attr("data-propid");resend_for_approval(t,$(this)),$(this).unbind("click")});var resend_for_approval=function(prop_id,currentDiv){var $messages=$("#houzez_messages");$.ajax({type:"POST",url:ajax_url,dataType:"JSON",data:{action:"houzez_resend_for_approval",propid:prop_id},beforeSend:function(){houzez_processing_modal(processing_text)},complete:function(){houzez_processing_modal_close()},success:function(e){e.success?(houzez_processing_modal_close(),window.location.reload()):(houzez_processing_modal_close(),$("html, body").animate({scrollTop:$(".dashboard-content").offset().top},"slow"),$messages.empty().append('<div class="alert alert-danger alert-dismissible fade show" role="alert">'+e.msg+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'))},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}})};$("#invoice-print-button").length>0&&$("#invoice-print-button").click(function(e){var invoiceID,printWindow;e.preventDefault(),invoiceID=$(this).attr("data-id"),printWindow=window.open("","Print Me","width=800 ,height=842"),$.ajax({type:"POST",url:ajax_url,data:{action:"houzez_create_invoice_print",invoice_id:invoiceID},success:function(e){printWindow.document.write(e),printWindow.document.close(),printWindow.focus()},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}})});var houzez_login_user_before_submit=function(currnt){var $form=currnt.parents("form"),$messages=$("#sumission_login_register_msgs"),sp_username=$("#sp_username").val(),sp_password=$("#sp_password").val(),security=$("#houzez_register_security2").val(),houzez_loggedin_success=$("#houzez_loggedin_success").val();1!=houzez_loggedin_success?$.ajax({type:"post",url:ajax_url,dataType:"json",data:{action:"houzez_login",username:sp_username,password:sp_password,houzez_register_security2:security,is_submit_listing:"yes"},beforeSend:function(){currnt.find(".houzez-loader-js").addClass("loader-show")},complete:function(){currnt.find(".houzez-loader-js").removeClass("loader-show")},success:function(e){e.success?($messages.empty().append('<div class="alert alert-success" role="alert"><i class="houzez-icon icon-check-circle-1 me-1"></i>'+e.msg+"</div>"),$("#submit_property_form").append('<input type="hidden" name="houzez_loggedin_success" id="houzez_loggedin_success" value="1">'),$("#submit_property_form").submit()):$messages.empty().append('<div class="alert alert-danger" role="alert"><i class="houzez-icon icon-check-circle-1 me-1"></i>'+e.msg+"</div>")},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}}):$("#submit_property_form").submit()};$('input[name="fave_agent_display_option"]').on("click",function(){var e=$(this).val();$(".agents-dropdown, .agencies-dropdown").hide(),"agent_info"==e?$(".agents-dropdown").show():"agency_info"==e&&$(".agencies-dropdown").show()});var houzez_register_login_user_before_submit=function(currnt){var $form=currnt.parents("form"),$messages=$("#sumission_login_register_msgs"),username=$("#username").val(),useremail=$("#user_email").val(),phone_number=$("#phone_number").val(),user_role=$("#user_role").val(),register_security=$("#houzez_register_security2").val(),houzez_registered_success=$("#houzez_registered_success").val();1!=houzez_registered_success?$.ajax({type:"post",url:ajax_url,dataType:"json",data:{action:"houzez_register_user_with_membership",username:username,useremail:useremail,phone_number:phone_number,first_name:"",last_name:"",user_role:user_role,houzez_register_security2:register_security,is_submit_listing:"yes"},beforeSend:function(){currnt.find(".houzez-loader-js").addClass("loader-show")},complete:function(){currnt.find(".houzez-loader-js").removeClass("loader-show")},success:function(e){e.success?($messages.empty().append('<div class="alert alert-success" role="alert"><i class="houzez-icon icon-check-circle-1 me-1"></i>'+e.msg+"</div>"),$("#submit_property_form").append('<input type="hidden" name="houzez_registered_success" id="houzez_registered_success" value="1">'),$("#submit_property_form").submit()):$messages.empty().append('<div class="alert alert-danger" role="alert"><i class="houzez-icon icon-check-circle-1 me-1"></i>'+e.msg+"</div>")},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}}):$("#submit_property_form").submit()};if("no"==houzez_logged_in){var add_new_property=$("#add_new_property");add_new_property.length>0&&add_new_property.on("click",function(e){e.preventDefault();var t=$(this);1==$("#login_while_submission").val()?houzez_login_user_before_submit(t):houzez_register_login_user_before_submit(t)})}$(".clone-property").on("click",function(e){e.preventDefault();var t=$(this),a=t.data("property"),o=t.data("nonce");$.ajax({url:ajax_url,data:{action:"houzez_property_clone",propID:a,security:o},method:"POST",dataType:"JSON",beforeSend:function(){houzez_processing_modal(processing_text)},success:function(e){e.success&&(window.location=e.data.redirect)},complete:function(){}})}),$(".put-on-hold").on("click",function(e){e.preventDefault();var t=$(this),a=t.data("property"),o=t.data("nonce");$.ajax({url:ajax_url,data:{action:"houzez_property_on_hold",propID:a,security:o},method:"POST",dataType:"JSON",beforeSend:function(){houzez_processing_modal(processing_text)},success:function(e){window.location.reload()},complete:function(){}})}),$(".put-on-hold-package").click(function(e){e.preventDefault();var t=$(this).data("property");put_on_hold_package(t,$(this)),$(this).unbind("click")});var put_on_hold_package=function(prop_id,currentDiv){var $messages=$("#houzez_messages");$.ajax({type:"POST",url:ajax_url,dataType:"JSON",data:{action:"houzez_property_on_hold_package",propid:prop_id},beforeSend:function(){houzez_processing_modal(processing_text)},complete:function(){houzez_processing_modal_close()},success:function(e){e.success?(houzez_processing_modal_close(),window.location.reload()):(houzez_processing_modal_close(),$("html, body").animate({scrollTop:$(".dashboard-content").offset().top},"slow"),$messages.empty().append('<div class="alert alert-danger alert-dismissible fade show" role="alert">'+e.msg+'<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'))},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}})};$(".mark_as_sold_js").on("click",function(e){e.preventDefault();var t=$(this),a=t.data("property"),o=t.data("nonce");$.ajax({url:ajax_url,data:{action:"houzez_property_mark_sold",propID:a,security:o},method:"POST",dataType:"JSON",beforeSend:function(){houzez_processing_modal(processing_text)},success:function(e){e.success&&window.location.reload()},complete:function(){}})}),$("a.relist-free").on("click",function(e){e.preventDefault();var t=$(this).data("property");$.ajax({url:ajax_url,data:{action:"houzez_relist_free",propID:t},method:"POST",dataType:"JSON",beforeSend:function(){houzez_processing_modal(processing_text)},success:function(e){window.location.reload()},complete:function(){}})});var houzez_validation=function(e){return 0!=e};$("#save_as_draft").on("click",function(){var $form=$("#submit_property_form"),save_as_draft=$("#save_as_draft");let $messages=$("#messages");var form_action=save_as_draft.data("action"),description=tinyMCE.get("property_description").getContent();$.ajax({type:"post",url:ajax_url,dataType:"json",data:$form.serialize()+"&action=save_as_draft&description="+description+"&form_action="+form_action,beforeSend:function(){$(".houzez-loader-js").addClass("loader-show")},complete:function(){$(".houzez-loader-js").removeClass("loader-show")},success:function(e){e.success?($("input[name=draft_property_id]").remove(),$("#submit_property_form").prepend('<input type="hidden" name="draft_property_id" value="'+e.property_id+'">'),jQuery("#modal-save-draft").modal("show")):houzez.Core.util.showError($messages,e.msg)},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}})});var title_length=function(){$("#prop_title").keyup(function(){var e=$(this).val().length;$("#rchars").text(e)})};1==enable_title_limit&&""!=property_title_limit&&title_length();var add_new_property_validation=function(){$("[data-hide]").on("click",function(){$(this).closest("."+$(this).attr("data-hide")).hide()});var e=1,t=$("#submit_property_form"),a=$(".form-step"),o=$(".form-step-gal"),r=($(".form-step-location"),$(".btn-next")),s=$(".btn-back"),i=$(".btn-cancel"),n=$(".btn-step-submit"),l=t.find("button[type='submit']"),c=$(".form-step-gal").data("gallery-reg");c=parseInt(c);var d=$(".menu-edit-property li a"),p=$("#menu_edit_mobile"),u=$(".validate-errors"),_=$(".validate-errors-gal");$(".property-thumb");$(".steps-total").html(a.length),a.not(":eq(0)").hide(),a.eq(0).addClass("active");var m=function(e){var t=parseInt(a.length);$(".action").hide(),e<t&&r.show(),e>1?(s.show(),i.hide()):(s.hide(),i.show()),e==t?(r.hide(),n.show()):n.hide()};m(e),d.on("click",function(e){e.preventDefault();var a=$(this),o=a.data("val"),r=$(".form-section-wrap");t.valid()?(u.hide(),d.removeClass("active"),a.addClass("active"),r.hide(),$("#"+o).show()):u.show()}),p.on("change",function(e){e.preventDefault();var a=$(this),o=a.val(),r=$(".form-section-wrap");t.valid()?(u.hide(),d.removeClass("active"),a.addClass("active"),r.hide(),$("#"+o).show()):u.show()}),r.click(function(r){if(r.preventDefault(),$("html, body").animate({scrollTop:$(".dashboard-content-block-wrap").offset().top-150},"slow"),dtGlobals.isiOS&&property_gallery_images(),e<a.length){if($(o).is(":visible")&&c){if(!$(".property-thumb").length>0)return $("#houzez_gallery_dragDrop").addClass("is-invalid"),void _.show();$("#houzez_gallery_dragDrop").removeClass("is-invalid"),_.hide()}t.valid()?(a.removeClass("active").css({display:"none"}),a.eq(e++).addClass("active").css({display:"block"}),u.hide()):(u.show(),t.find("select").selectpicker("refresh"))}m(e),$(".steps-counter").html(e)}),s.click(function(t){t.preventDefault(),u.hide(),$("html, body").animate({scrollTop:$(".dashboard-content-block-wrap").offset().top-150},"slow"),e>1&&(e-=2)<a.length&&(a.removeClass("active").css({display:"none"}),a.eq(e++).addClass("active").css({display:"block"})),m(e),$(".steps-counter").html(e)}),l.click(function(){if($(o).is(":visible")&&c){if(!$(".property-thumb").length>0)return $("#houzez_gallery_dragDrop").addClass("is-invalid"),_.show(),$("html, body").animate({scrollTop:$(".form-step-gal").offset().top},"slow"),!1;$("#houzez_gallery_dragDrop").removeClass("is-invalid"),_.hide()}t.valid()?u.hide():(u.show(),$("html, body").animate({scrollTop:$(".dashboard-content-block-wrap").offset().top-150},"slow"))}),t.length>0&&t.validate({ignore:":hidden:not(.submit-form-wrap .account-block.active .selectpicker)",errorPlacement:function(e,t){return!1},rules:{},messages:{},highlight:function(e,t,a){$(e).addClass("is-invalid").removeClass("is-valid"),$(e).parent(".bootstrap-select").addClass("is-invalid").removeClass("is-valid"),$(e).parent(".control--checkbox").find(".control__indicator").addClass("is-invalid").removeClass("is-valid")},unhighlight:function(e,t,a){$(e).removeClass("is-invalid"),$(e).parent(".bootstrap-select").removeClass("is-invalid"),$(e).parent(".control--checkbox").find(".control__indicator").removeClass("is-invalid")},submitHandler:function(e){$(".houzez-submit-js").attr("disabled",!0),$(".houzez-submit-js .houzez-loader-js").addClass("loader-show"),e.submit()}})};add_new_property_validation(),$("#houzez_additional_details_main").sortable({revert:100,placeholder:"detail-placeholder",handle:".sort-additional-row",cursor:"move"}),$(".add-additional-row").click(function(e){e.preventDefault();var t=$(this).data("increment")+1;$(this).data("increment",t),$(this).attr({"data-increment":t});var a='<tr><td><input class="form-control" type="text" name="additional_features['+t+'][fave_additional_feature_title]" id="fave_additional_feature_title_'+t+'" value=""></td><td><input class="form-control" type="text" name="additional_features['+t+'][fave_additional_feature_value]" id="fave_additional_feature_value_'+t+'" value=""></td><td style="width: 0;" colspan="2"><div class="d-flex justify-content-end align-items-center gap-1 ms-1"><a class="sort-additional-row btn btn-light-grey-outlined"><i class="houzez-icon icon-navigation-menu"></i></a><button data-remove="'+t+'" class="remove-additional-row btn btn-light-grey-outlined"><i class="houzez-icon icon-close"></i></button></div></td></tr>';$("#houzez_additional_details_main").append(a),removeAdditionalDetails()});var removeAdditionalDetails=function(){$(".remove-additional-row").click(function(e){e.preventDefault(),$(this).closest("tr").remove()})};removeAdditionalDetails(),$("#add-floorplan-row").click(function(e){e.preventDefault();var t=$(this).data("increment")+1;$(this).data("increment",t),$(this).attr({"data-increment":t});var a='<div class="houzez-floorplan-clone"><div class="row"><div class="col-md-12 col-sm-12 position-relative"><div class="remove-floorplan-row position-absolute" style="right: 0; top: 0; cursor: pointer; color: red;" data-remove="'+t+'"><i class="houzez-icon icon-remove-circle me-1"></i></div><div class="mb-3"><label class="form-label" for="floor_plans['+t+'][fave_plan_title]">'+plan_title_text+'</label><input name="floor_plans['+t+'][fave_plan_title]" type="text" id="fave_plan_title_'+t+'" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="floor_plans['+t+'][fave_plan_rooms]">'+plan_bedrooms_text+'</label><input name="floor_plans['+t+'][fave_plan_rooms]" type="text" id="fave_plan_rooms_'+t+'" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="floor_plans['+t+'][fave_plan_bathrooms]">'+plan_bathrooms_text+'</label><input name="floor_plans['+t+'][fave_plan_bathrooms]" type="text" id="fave_plan_bathrooms_'+t+'" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="floor_plans['+t+'][fave_plan_price]">'+plan_price_text+'</label><input name="floor_plans['+t+'][fave_plan_price]" type="text" id="fave_plan_price_'+t+'" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="floor_plans['+t+'][fave_plan_price_postfix]">'+plan_price_postfix_text+'</label><input name="floor_plans['+t+'][fave_plan_price_postfix]" type="text" id="fave_plan_price_postfix_'+t+'" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="floor_plans['+t+'][fave_plan_size]">'+plan_size_text+'</label><input name="floor_plans['+t+'][fave_plan_size]" type="text" id="fave_plan_size_'+t+'" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="floor_plans['+t+'][fave_plan_image]">'+plan_image_text+'</label><div class="d-flex align-items-start"><img class="floor-thumb img-fluid" src="https://placehold.it/100x75" width="100" height="75" alt="thumb"><div class="ml-2"><a href="#" id="floorplan-file-select-'+t+'" class="floorplan-file-select btn btn-primary btn-full-width">'+plan_upload_text+'</a><input name="floor_plans['+t+'][fave_plan_image]" type="hidden" id="fave_plan_image_'+t+'" class="fave_plan_image form-control" value=""><small class="form-text text-muted">'+houzezProperty.plan_upload_size+'</small><div class="errors-log"></div><div class="progress houzez-hidden"></div></div></div></div></div><div class="col-md-12 col-sm-12"><div class="mb-3"><label class="form-label" for="floor_plans['+t+'][fave_plan_description]">'+plan_description_text+'</label><textarea name="floor_plans['+t+'][fave_plan_description]" rows="4" id="fave_plan_description_'+t+'" class="form-control"></textarea></div></div></div><hr></div>';$("#houzez_floor_plans_main").append(a),removeFloorPlans(),bindFloorPlanEvents()});var removeFloorPlans=function(){$(".remove-floorplan-row").click(function(e){e.preventDefault(),$(this).parents(".houzez-floorplan-clone").remove()})};removeFloorPlans(),$("#add-subproperty-row").click(function(e){e.preventDefault();var t=$(this).data("increment")+1;$(this).data("increment",t),$(this).attr({"data-increment":t});var a='<div class="houzez-units-clone"><div class="row"><div class="col-md-12 col-sm-12 position-relative"><div class="remove-subproperty-row position-absolute" style="right: 0; top: 0; cursor: pointer; color: red;" data-remove="'+t+'"><i class="houzez-icon icon-remove-circle me-2"></i></div><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_title]">'+mu_title_text+'</label><input name="fave_multi_units['+t+'][fave_mu_title]" type="text" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_beds]">'+mu_beds_text+'</label><input name="fave_multi_units['+t+'][fave_mu_beds]" type="text" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_baths]">'+mu_baths_text+'</label><input name="fave_multi_units['+t+'][fave_mu_baths]" type="text" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_size]">'+mu_size_text+'</label><input name="fave_multi_units['+t+'][fave_mu_size]" type="text" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_size_postfix]">'+mu_size_postfix_text+'</label><input name="fave_multi_units['+t+'][fave_mu_size_postfix]" type="text" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_price]">'+mu_price_text+'</label><input name="fave_multi_units['+t+'][fave_mu_price]" type="text" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_price_postfix]">'+mu_price_postfix_text+'</label><input name="fave_multi_units['+t+'][fave_mu_price_postfix]" type="text" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_type]">'+mu_type_text+'</label><input name="fave_multi_units['+t+'][fave_mu_type]" type="text" class="form-control"></div></div><div class="col-md-6 col-sm-12"><div class="mb-3"><label class="form-label" for="fave_multi_units['+t+'][fave_mu_availability_date]">'+mu_availability_text+'</label><input name="fave_multi_units['+t+'][fave_mu_availability_date]" type="text" class="form-control"></div></div></div><hr></div>';$("#multi_units_main").append(a),removeSubProperty()});var removeSubProperty=function(){$(".remove-subproperty-row").click(function(e){e.preventDefault(),$(this).parents(".houzez-units-clone").remove()})};removeSubProperty();var property_gallery_images=function(){$("#houzez_property_gallery_container").sortable({items:".property-thumb",placeholder:"sortable-placeholder",revert:150,cursor:"grabbing",opacity:.8,scroll:!0,scrollSensitivity:30,scrollSpeed:10,tolerance:"pointer",start:function(e,t){t.placeholder.height(t.item.height()),t.placeholder.width(t.item.width()),t.item.addClass("sorting")},stop:function(e,t){t.item.removeClass("sorting")},update:function(e,t){$(this).trigger("gallery-sort-update")}}),$("<style>").text("\n                    .sortable-placeholder {\n                        background: #f7f7f7;\n                        border: 2px dashed #ccc;\n                        border-radius: 4px;\n                        margin: 5px;\n                        display: inline-block;\n                    }\n                    .property-thumb.sorting {\n                        box-shadow: 0 0 10px rgba(0,0,0,0.2);\n                        z-index: 1000;\n                    }\n                    #houzez_property_gallery_container {\n                        min-height: 50px;\n                    }\n                ").appendTo("head");var e=new plupload.Uploader({browse_button:"select_gallery_images",file_data_name:"property_upload_file",container:"houzez_gallery_dragDrop",drop_element:"houzez_gallery_dragDrop",url:ajax_url+"?action=houzez_property_img_upload&verify_nonce="+verify_nonce,filters:{mime_types:[{title:verify_file_type,extensions:"jpg,jpeg,gif,png,webp"}],max_file_size:image_max_file_size,prevent_duplicates:!1}});e.init(),e.bind("FilesAdded",function(t,a){var o=max_prop_images,r=$(".property-thumb").length;if(r>=o)return $(".max-limit-error").show(),t.splice(),!1;var s=a.slice(0,o-r),i=document.getElementById("houzez_property_gallery_container");plupload.each(s,function(e){i.innerHTML+='<div id="thumb-holder-'+e.id+'" class="col-md-2 col-sm-4 col-6 property-thumb houzez-during-upload"></div>'}),t.refresh(),e.start(),$(".upload-image-counter .uploaded").text($(".property-thumb").length)}),e.bind("UploadProgress",function(e,t){var a=document.getElementById("thumb-holder-"+t.id),o=$(".property-thumb"),r=150;return a&&o.length&&0==(r=o.first().height())&&(r=141),a.innerHTML='<div class="gallery-thumb-inner upload-progress" style="height:'+r+'px;"><span class="progress-bar"></span><span class="progress" style="width:'+t.percent+'%;"></span><span class="progress-text">'+t.percent+"%</span></div>",!1}),e.bind("Error",function(e,t){document.getElementById("houzez_errors").innerHTML+="<br/>Error #"+t.code+": "+t.message}),e.bind("FileUploaded",function(e,t,a){var o=$.parseJSON(a.response),r=document.getElementById("thumb-holder-"+t.id);if(o.success){if(document.getElementById("houzez_errors").innerHTML="",r){var s='<img class="img-fluid" src="'+o.url+'" alt="" /><div class="upload-gallery-thumb-buttons d-flex justify-content-between align-items-center"><button class="icon icon-fav icon-featured" data-property-id="0" data-attachment-id="'+o.attachment_id+'"><i class="houzez-icon icon-rating-star full-star"></i></button><button class="icon icon-delete" data-property-id="0" data-attachment-id="'+o.attachment_id+'"><span class="houzez-loader-js houzez-hidden spinner-border spinner-border-sm"></span><i class="houzez-icon icon-remove-circle"></i></button></div><input type="hidden" class="propperty-image-id" name="propperty_image_ids[]" value="'+o.attachment_id+'"/>';r.innerHTML=s}}else r&&r.remove(),document.getElementById("houzez_errors").innerHTML=o.reason}),$(document).on("click",".icon-featured",function(e){e.preventDefault();var t=jQuery(this),a=t.data("attachment-id");$(".property-thumb .featured_image_id").remove(),$(".property-thumb .icon-featured").removeClass("text-success"),t.closest(".property-thumb").append('<input type="hidden" class="featured_image_id" name="featured_image_id" value="'+a+'">'),t.addClass("text-success")}),$(document).on("click",".icon-delete",function(t){t.preventDefault();var a=$(this),o=a.closest(".property-thumb"),r=a.siblings(".icon-loader"),s=a.data("property-id"),i=a.data("attachment-id");r.show();var n=$.ajax({type:"post",url:ajax_url,dataType:"json",data:{action:"houzez_remove_property_thumbnail",prop_id:s,thumb_id:i,removeNonce:verify_nonce},beforeSend:function(){a.find(".houzez-loader-js").addClass("loader-show")}});n.done(function(t){if(t.remove_attachment){e.removeFile(o),o.remove();var a=$(".property-thumb").length;$(".upload-image-counter .uploaded").text(a),$(".max-limit-error").hide()}else document.getElementById("houzez_errors").innerHTML+="Error : Failed to remove attachment<br/>"}),n.fail(function(e,t){alert("Request failed: "+t)}),e.splice()})};property_gallery_images();var propertyAttachmentEvents=function(){$("#houzez_attachments_container").sortable({revert:100,placeholder:"attachments-placeholder",handle:".sort-attachment",cursor:"move"}),$(".attachment-delete").on("click",function(e){e.preventDefault();var t=$(this),a=t.closest(".attach-thumb"),o=t.siblings(".icon-loader"),r=t.data("attach-id"),s=t.data("attachment-id");o.show();var i=$.ajax({type:"post",url:ajax_url,dataType:"json",data:{action:"houzez_remove_property_documents",prop_id:r,thumb_id:s,removeNonce:verify_nonce}});i.done(function(e){e.remove_attachment&&a.remove()}),i.fail(function(e,t){alert("Request failed: "+t)})})};propertyAttachmentEvents();var houzez_property_attachments=function(){var e=new plupload.Uploader({browse_button:"select_attachments",file_data_name:"property_attachment_file",url:ajax_url+"?action=houzez_property_attachment_upload&verify_nonce="+verify_nonce,filters:{mime_types:[{title:verify_file_type,extensions:"jpg,jpeg,png,pdf,zip"}],max_file_size:attachment_max_file_size,prevent_duplicates:!0}});e.init(),e.bind("FilesAdded",function(t,a){var o="",r=max_prop_attachments;if(t.files.length>r)return t.splice(r),void alert("no more than "+r+" file(s)");plupload.each(a,function(e){o+='<tr id="attachment-holder-'+e.id+'" class="attach-thumb"></tr>'}),document.getElementById("houzez_attachments_container").innerHTML+=o,t.refresh(),e.start()}),e.bind("UploadProgress",function(e,t){document.getElementById("attachment-holder-"+t.id).innerHTML="<span>"+t.percent+"%</span>"}),e.bind("Error",function(e,t){document.getElementById("houzez_atach_errors").innerHTML+="<br/>Error #"+t.code+": "+t.message}),e.bind("FileUploaded",function(e,t,a){var o=$.parseJSON(a.response);if(o.success){var r='<td class="w-100"><span>'+o.attach_title+'</span></td><td><a href="'+o.url+'" target="_blank" class="btn btn-light-grey-outlined"><i class="houzez-icon icon-download-bottom"></i></a></td><td><button data-attach-id="0"  data-attachment-id="'+o.attachment_id+'" class="attachment-delete btn btn-light-grey-outlined"><i class="houzez-icon icon-close"></i></button></td><td class="sort-attachment"><a class="btn btn-light-grey-outlined"><i class="houzez-icon icon-navigation-menu"></i></a></td><input type="hidden" class="propperty-attach-id" name="propperty_attachment_ids[]" value="'+o.attachment_id+'"/>';document.getElementById("attachment-holder-"+t.id).innerHTML=r,propertyAttachmentEvents()}})};houzez_property_attachments();var floorPlanImage=function(e){var t=$("#"+(e=e||"floorplan-file-select")).parents(".houzez-floorplan-clone"),a=t.find(".errors-log"),o=new plupload.Uploader({browse_button:e,file_data_name:"property_upload_file",url:ajax_url+"?action=houzez_property_img_upload&verify_nonce="+verify_nonce,multi_selection:!1,filters:{mime_types:[{title:verify_file_type,extensions:"jpg,jpeg,gif,pdf,png,webp"}],max_file_size:"12000kb",prevent_duplicates:!0}});o.init(),o.bind("FilesAdded",function(e,t){var a=max_prop_images;if(e.files.length>a)return e.splice(a),void alert("no more than "+a+" file(s)");plupload.each(t,function(e){}),e.refresh(),o.start()}),o.bind("UploadProgress",function(e,a){t.find(".progress").removeClass("houzez-hidden"),t.find(".progress").html('<div class="progress-bar" role="progressbar" style="width: '+a.percent+'%" aria-valuenow="'+a.percent+'" aria-valuemin="0" aria-valuemax="100"></div>')}),o.bind("Error",function(e,t){a.html("Error #"+t.code+": "+t.message)}),o.bind("FileUploaded",function(e,o,r){var s=$.parseJSON(r.response);s.success?(a.html(""),t.find(".fave_plan_image").val(s.full_image),t.find(".floor-thumb").attr("src",s.full_image),t.find(".progress").html(""),t.find(".progress").addClass("houzez-hidden")):(a.html(s.reason),t.find(".floor-thumb").attr("src",""),t.find(".progress").html(""),t.find(".progress").addClass("houzez-hidden"))})},bindFloorPlanEvents=function(){var e=$(".houzez-floorplan-clone");$.each(e,function(e,t){var a=$(t).find(".floorplan-file-select").attr("id");floorPlanImage(a)})};bindFloorPlanEvents();var thread_message_attachment=function(){var e=new plupload.Uploader({browse_button:"thread-message-attachment",file_data_name:"messages_upload_file",container:"property-thumbs-container",multi_selection:!0,url:ajax_url+"?action=houzez_message_attacment_upload&verify_nonce="+verify_nonce,filters:{max_file_size:image_max_file_size,prevent_duplicates:!0}});e.init(),e.bind("FilesAdded",function(t,a){var o="",r=max_prop_images;if(t.files.length>r)return t.splice(r),void alert("no more than "+r+" file(s)");plupload.each(a,function(e){o+='<div id="thumb-holder-'+e.id+'" class="property-thumb"></div>'}),document.getElementById("property-thumbs-container").innerHTML+=o,t.refresh(),e.start()}),e.bind("UploadProgress",function(e,t){document.getElementById("thumb-holder-"+t.id).innerHTML="<li><lable>"+t.name+"<span>"+t.percent+"%</span></lable></li>"}),e.bind("Error",function(e,t){document.getElementById("errors-log").innerHTML+="<br/>Error #"+t.code+": "+t.message}),e.bind("FileUploaded",function(e,t,a){var o=$.parseJSON(a.response);if(o.success){var r='<li><div class="attach-icon delete-attachment"><i class="fa fa-trash remove-message-attachment" data-attachment-id="'+o.attachment_id+'"></i></div><span class="attach-text">'+o.file_name+'</span><input type="hidden" class="propperty-image-id" name="propperty_image_ids[]" value="'+o.attachment_id+'"/></li>';document.getElementById("thumb-holder-"+t.id).innerHTML=r,messageAttachment(),thread_message_attachment()}else alert("error")}),e.refresh()};thread_message_attachment();var messageAttachment=function(){$(".remove-message-attachment").on("click",function(){var e=$(this),t=e.closest("li"),a=e.data("attachment-id");e.removeClass("fa-trash"),e.addClass("fa-spinner");var o=$.ajax({type:"post",url:ajax_url,dataType:"json",data:{action:"houzez_remove_message_attachment",thumbnail_id:a}});o.done(function(e){e.attachment_remove&&t.remove(),thread_message_attachment()}),o.fail(function(e,t){alert("Request failed: "+t)})})};$(".houzez_delete_msg_thread").on("click",function(e){e.preventDefault();var t=$(this),a=t.data("thread-id"),o=t.data("sender-id"),r=t.data("receiver-id");bootbox.confirm({message:"<p><strong>"+are_you_sure_text+"</strong></p>",closeButton:!1,buttons:{confirm:{label:delete_btn_text,className:"btn btn-primary"},cancel:{label:cancel_btn_text,className:"btn btn-grey-outlined"}},callback:function(e){1==e&&(houzez_processing_modal(processing_text),$.ajax({type:"POST",dataType:"json",url:ajax_url,data:{action:"houzez_delete_message_thread",thread_id:a,sender_id:o,receiver_id:r},beforeSend:function(){},success:function(e){1==e.success?window.location.reload():jQuery("#fave_modal").modal("hide")},error:function(e){}}))}})}),$(".houzez_delete_message").on("click",function(e){e.preventDefault();var t=$(this),a=t.data("message-id"),o=t.data("created-by");bootbox.confirm({message:"<p><strong>"+are_you_sure_text+"</strong></p>",closeButton:!1,buttons:{confirm:{label:delete_btn_text,className:"btn btn-primary"},cancel:{label:cancel_btn_text,className:"btn btn-grey-outlined"}},callback:function(e){1==e&&(houzez_processing_modal(processing_text),$.ajax({type:"POST",dataType:"json",url:ajax_url,data:{action:"houzez_delete_message",message_id:a,created_by:o},beforeSend:function(){},success:function(e){1==e.success?window.location.reload():jQuery("#fave_modal").modal("hide")},error:function(e){}}))}})}),$(".start_thread_message_form").on("click",function(e){e.preventDefault();let t=$(this),a=t.parents("form");a.find(".form_messages");$.ajax({url:ajax_url,data:a.serialize(),method:a.attr("method"),dataType:"JSON",beforeSend:function(){t.find(".houzez-loader-js").addClass("loader-show")},success:function(e){t.find(".houzez-loader-js").removeClass("loader-show"),window.location.replace(e.url)},complete:function(){t.find(".houzez-loader-js").removeClass("loader-show")}})}),$(".remove-search").on("click",function(e){e.preventDefault();var $this=$(this),prop_id=$this.data("propertyid"),removeBlock=$this.parents(".saved-search-block");$this.parents("tr").remove(),$.ajax({url:ajax_url,dataType:"JSON",method:"POST",data:{action:"houzez_delete_search",property_id:prop_id},beforeSend:function(){},success:function(e){e.success},error:function(xhr,status,error){var err=eval("("+xhr.responseText+")")}})});var login_here=$(".login-here"),register_here=$(".register-here"),step_login=$(".step-tab-login"),step_register=$(".step-tab-register");$(".step-login-btn a").on("click",function(e){var t=$(this);t.hasClass("login-here")?(t.hide(),register_here.show(),step_login.show(),step_register.hide(),$("#submit_property_form").append('<input type="hidden" name="login_while_submission" id="login_while_submission" value="1">')):(t.hide(),login_here.show(),step_login.hide(),step_register.show(),$("#login_while_submission").remove()),e.preventDefault()});var deals_doughnut_chart=$("#deals-doughnut-chart");if(deals_doughnut_chart.length>0)var active_deals=deals_doughnut_chart.data("active"),won_deals=deals_doughnut_chart.data("won"),lost_deals=deals_doughnut_chart.data("lost"),ctx=document.getElementById("deals-doughnut-chart").getContext("2d"),myDoughnutChart=new Chart(ctx,{type:"doughnut",data:{datasets:[{data:[active_deals,won_deals,lost_deals],backgroundColor:["rgba(255, 206, 86, 0.5)","rgba(75, 192, 192, 0.5)","rgba(255, 99, 132, 0.5)"],borderColor:["rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(255 ,99, 132, 1)"],borderWidth:1}]},options:{cutoutPercentage:60,responsive:!1,tooltips:!1}});var HouzezCheckboxManager=function(){function e(e,t,a){var o=e.find(a).length,r=e.find(a+":checked").length;e.find(t).prop("checked",o>0&&o===r)}return{init:function(t,a,o){var r=$(t);r.length&&(r.on("change",a,function(){var e=$(this).prop("checked");r.find(o).prop("checked",e)}),r.on("change",o,function(){e(r,a,o)}),e(r,a,o))}}}();function houzezDeleteProperties(e,t){Array.isArray(e)||(e=[e]),$.ajax({url:ajax_url,type:"POST",dataType:"json",data:{action:"houzez_delete_properties",property_ids:e,security:t},beforeSend:function(){houzez_processing_modal(processing_text)},success:function(t){houzez_processing_modal_close(),t.success?($("#houzez_messages").append('<div class="alert alert-success alert-dismissible fade show mt-3">'+(t.data&&t.data.message?t.data.message:"Properties successfully deleted")+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>'),e.length>1&&(e.forEach(function(e){$('input.listing-bulk-delete[value="'+e+'"]').closest("tr").remove()}),$("#listing_select_all").prop("checked",!1)),setTimeout(function(){location.reload()},800)):$("#houzez_messages").append('<div class="alert alert-danger alert-dismissible fade show mt-3">'+(t.data&&t.data.message?t.data.message:"Error deleting properties")+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>')},error:function(e,t,a){houzez_processing_modal_close(),$("#houzez_messages").append('<div class="alert alert-danger alert-dismissible fade show mt-3">'+(a||"An error occurred while deleting properties")+'<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>')}})}$(document).ready(function(){HouzezCheckboxManager.init(".houzez-data-table","#listing_select_all",".listing-bulk-delete")}),$(document).on("click","a.delete-property",function(e){e.preventDefault();var t=$(this),a=t.data("id"),o=t.data("nonce");bootbox.confirm({message:"<strong>"+houzezProperty.delete_confirmation+"</strong>",closeButton:!1,buttons:{confirm:{label:houzezProperty.delete_btn_text,className:"btn btn-primary"},cancel:{label:houzezProperty.cancel_btn_text,className:"btn btn-grey-outlined"}},callback:function(e){e&&houzezDeleteProperties(a,o)}})}),$("#bulk-action-apply").on("click",function(e){if(e.preventDefault(),"Delete"===$("#bulk-action-select").val()){var t=$(".listing-bulk-delete:checked").map(function(){return $(this).val()}).get();if(t.length){var a=$("#bulk-action-nonce").val();bootbox.confirm({message:"<strong>"+houzezProperty.delete_confirmation+"</strong>",closeButton:!1,buttons:{confirm:{label:houzezProperty.delete_btn_text,className:"btn btn-primary"},cancel:{label:houzezProperty.cancel_btn_text,className:"btn btn-grey-outlined"}},callback:function(e){e&&houzezDeleteProperties(t,a)}})}else alert(houzezProperty.no_item_selected)}else alert(houzezProperty.select_action)})}});