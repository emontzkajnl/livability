!function(e){"use strict";var t=window.houzez||{};t.MapboxUtils=function(){let o="",a="",n="",r="",i=new Array,l=0,s=0,p=null,c="en";"undefined"!=typeof houzez_vars&&(a=houzez_vars.admin_url+"admin-ajax.php",n=houzez_vars.user_id,r=houzez_vars.not_found,o=houzez_vars.thousands_separator,c=houzez_vars.mapboxLocaleShort);const u=()=>!!window.matchMedia("(max-width: 991px)").matches||(!0===navigator.userAgentData?.mobile||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),d=function(){return{"&amp;":"&","&quot;":'"',"&#039;":"'","&#8217;":"’","&#038;":"&","&lt;":"<","&gt;":">","&#8216;":"‘","&#8230;":"…","&#8221;":"”","&#8211;":'â€"',"&#8212;":'â€"'}},m=function(e){e.getLayer("markers")&&e.removeLayer("markers"),e.getLayer("clusters")&&e.removeLayer("clusters"),e.getLayer("cluster-count")&&e.removeLayer("cluster-count"),e.getSource("properties")&&e.removeSource("properties");for(let e=0;e<i.length;e++)i[e]&&i[e].remove();i=[],t.MapboxUtils.clearMarkers()},g=function(e){i.push(e)},h=function(){i=[]},f=function(){if(p){try{p.remove()}catch(e){}p=null}i.forEach(function(e){if(e&&e._popup&&e._popup.isOpen())try{e._popup.remove()}catch(e){}})},z=function(e){for(let t=0;t<i.length;t++)if(i[t].propertyId&&i[t].propertyId==e)return i[t];return null},b=function(e,t=!0){if(e){"string"==typeof e&&0===e.indexOf("hz-")&&(e=e.replace("hz-","")),f();for(let o=0;o<i.length;o++)if(i[o].propertyId==e){if(l=o+1,s=e,t&&window.houzezMap){const e=window.houzezMap.getZoom();window.houzezMap.easeTo({center:i[o].getLngLat(),zoom:e,duration:500})}i[o]._popup&&(i[o].togglePopup(),p=i[o]._popup);break}}},x=function(e){if(e){"string"==typeof e&&0===e.indexOf("hz-")&&(e=e.replace("hz-",""));for(let t=0;t<i.length;t++)if(i[t].propertyId==e&&i[t]._popup&&i[t]._popup.isOpen()){i[t].togglePopup(),p=null;break}}},v=function(e){window.history.pushState({houzezTheme:!0},"",e)};return{init:function(){},addCommas:function(e){for(var t=(e+="").split("."),o=t[0],a=t.length>1?"."+t[1]:"",n=/(\d+)(\d{3})/;n.test(o);)o=o.replace(n,"$1,$2");return o+a},thousandSeparator:e=>{if("number"==typeof e){for(var t=(e+="").split("."),a=t[0],n=t.length>1?"."+t[1]:"",r=/(\d+)(\d{3})/;r.test(a);)a=a.replace(r,"$1"+o+"$2");return a+n}return e},processSpecialChars:d,remove_map_loader:function(e){e.on("load",function(){jQuery(".houzez-map-loading").hide()})},reloadMarkers:m,clearClusterer:function(e){m(e)},map_bounds:function(e){if(i.length>0){const t=new mapboxgl.LngLatBounds;i.forEach(function(e){t.extend(e.getLngLat())}),e.fitBounds(t,{padding:50})}},change_map_type:function(e){return!!houzezMap&&("streets"===e?houzezMap.setStyle("mapbox://styles/mapbox/streets-v12"):"satellite"===e?houzezMap.setStyle("mapbox://styles/mapbox/satellite-v9"):"hybrid"===e?houzezMap.setStyle("mapbox://styles/mapbox/satellite-streets-v12"):"terrain"===e&&houzezMap.setStyle("mapbox://styles/mapbox/outdoors-v12"),!1)},map_next:function(){if(l++,l>i.length&&(l=1),i[l-1]){const e=i[l-1];e.propertyId&&b(e.propertyId,!1)}},map_prev:function(){if(l--,l<1&&(l=i.length),i[l-1]){const e=i[l-1];e.propertyId&&b(e.propertyId,!1)}},openPopup:b,openPopupById:function(e,t=!0){f();z(e)&&b(e,t)},closePopup:x,hideInfoWindows:f,findMarkerByPropertyId:z,addMarkers:function(e,o=!1){h();for(var a=0;a<e.length;a++)if(e[a].latitude&&e[a].longitude){let o=e[a].marker_color,n=document.createElement("div");n.className="mapbox-marker","yes"==t.Mapbox.getMarkerPricePins()?(n.className+=" map-marker-label",n.innerHTML=e[a].pricePin,o?(n.style.backgroundColor=o,n.style.borderColor=o,n.style.color="#ffffff",n.style.setProperty("--triangle-color",o)):n.style.setProperty("--triangle-color","#1DABE3")):(n.style.backgroundImage="url("+(e[a].marker||"")+")",n.style.width="44px",n.style.height="56px",n.style.backgroundSize="contain",n.style.backgroundRepeat="no-repeat");let r=document.createElement("div");r.className="property-info-window";let i="";e[a].thumbnail?i+='<div class="info-window-image">'+e[a].featured_label+'<a target="'+e[a].link_target+'" href="'+e[a].url+'"><img class="img-fluid listing-thumbnail" src="'+t.Mapbox.getInfoWindowPlac()+'" data-src="'+e[a].thumbnail+'" alt="'+e[a].title+'"/></a></div>':i+='<div class="info-window-image">'+e[a].featured_label+'<a target="'+e[a].link_target+'" href="'+e[a].url+'"><img class="img-fluid listing-thumbnail" src="'+t.Mapbox.getInfoWindowPlac()+'" alt="'+e[a].title+'"/></a></div>',i+='<div class="info-content" style="padding:10px;">',e[a].price&&(i+='<div class="info-window-price">'+e[a].price+"</div>"),i+=e[a].meta,e[a].property_type&&(i+='<div class="info-window-property-type">'+e[a].property_type+"</div>"),i+=e[a].address,i+="</div>",r.innerHTML=i;const c=e[a].property_id||"",u=new mapboxgl.Popup({offset:25,closeButton:!0,closeOnClick:!1,maxWidth:"320px"}).setDOMContent(r);u.on("open",function(){let e=r.getElementsByClassName("listing-thumbnail");e.length&&e[0].dataset.src&&"undefined"!==e[0].dataset.src&&(e[0].src=e[0].dataset.src),p=u}),u.on("close",function(){p===u&&(p=null)});const d=new mapboxgl.Marker({element:n,clickTolerance:10}).setLngLat([parseFloat(e[a].longitude),parseFloat(e[a].latitude)]).setPopup(u).addTo(window.houzezMap);d.propertyId=c,d.getElement().addEventListener("click",function(e){e.stopPropagation(),f(),l=a+1,s=c,b(c,!1)}),g(d)}o||(e=>{if(!i.length)return;let o=t.Mapbox.getDefaultZoom();const a=i.reduce((e,t)=>e.extend(t.getLngLat()),new mapboxgl.LngLatBounds),n=a.isEmpty(),r=!n&&(Math.abs(a.getNorth()-a.getSouth())<1e-6||Math.abs(a.getEast()-a.getWest())<1e-6);if(n||r){let t;return n?t=i.length?i[0].getLngLat():e.getCenter():(t=[(a.getWest()+a.getEast())/2,(a.getNorth()+a.getSouth())/2],t.lng||(t=new mapboxgl.LngLat(t[0],t[1]))),e.setCenter(t),void e.setZoom(o)}e.fitBounds(a,{padding:30,animate:!1,maxZoom:o+2}),e.getZoom()>o&&e.setZoom(o)})(window.houzezMap)},setPushState:v,set_url:function(t){var o=t||e("form.houzez-search-filters-js").first(),a=o.attr("action");if(null==a)return!0;var n=o.find(":input").filter(function(t,o){if(!e(o).prop("disabled")&&""!=e(o).val()&&"search_geolocation"!=e(o).attr("name")&&"search_URI"!=e(o).attr("name")&&"search_args"!=e(o).attr("name")&&"houzez_save_search_ajax"!=e(o).attr("name"))return!0}).serialize();a=null==a?"":(a.indexOf("?"),a+"?"+n),v(a)},initMapViewToggle:function(){e("#houzez-btn-map-view").on("click",function(t){t.preventDefault(),e("#half-map-listing-area, .listing-wrap").hide(),e("#map-view-wrap").show(),e("#mobile-search-form").addClass("hz-mobile-overlay-search-js"),window.setTimeout(function(){window.dispatchEvent(new Event("resize")),window.houzezMap&&window.houzezMap.resize()},100)}),e("#houzez-btn-listing-view").on("click",function(o){o.preventDefault(),e("#map-view-wrap").hide(),e("#half-map-listing-area, .listing-wrap").show(),e("#mobile-search-form").removeClass("hz-mobile-overlay-search-js"),e(".hz-item-gallery-js").removeClass("houzez-gallery-loaded"),window.setTimeout(function(){t.Core&&"function"==typeof t.Core.reinitializeAjaxFunctions&&t.Core.reinitializeAjaxFunctions()},100)})},initializeFullScreenToggle:function(){e("#houzez-gmap-full, #houzez-gmap-full-osm").on("click",function(){var t=e(this);t.hasClass("active")?(t.removeClass("active"),t.parents(".map-wrap").removeClass("houzez-fullscreen-map")):(t.parents(".map-wrap").addClass("houzez-fullscreen-map"),t.addClass("active")),window.setTimeout(function(){if(window.dispatchEvent(new Event("resize")),window.houzezMap&&(window.houzezMap.resize(),window.houzezMap.getCenter))try{window.houzezMap.panTo(window.houzezMap.getCenter())}catch(e){}},100)})},initInfoboxTrigger:function(){if(u())return;const e=document.querySelectorAll("#half-map-listing-area .hz-map-trigger");e.length&&e.forEach(function(e){const t=e.getAttribute("data-hz-id");t&&(e.addEventListener("mouseenter",function(){b(t,!1)}),e.addEventListener("mouseleave",function(){x(t)}))})},getAjaxUrl:()=>a,getUserId:()=>n,getMapLanguage:()=>c,getNotFound:()=>r,getThousandsSeparator:()=>o,getMarkers:()=>i,getCurrentMarker:()=>l,getCurrentMarkerId:()=>s,addMarker:g,clearMarkers:h,initMapSearchHandlers:function(){e(".houzez_ajax_pagination a").on("click",function(o){o.preventDefault();const a=e(this).data("houzepagi")||0;let n=e("#desktop-search-form");e("#mobile-search-form.apply-mobile-pagination").length>0&&(n=e("#mobile-search-form")),t.Mapbox.searchOnChange(null,n,a)}),e("#ajax_sort_properties").on("change",function(){let o=e("#desktop-search-form");e(this).hasClass("mobile-sortby")&&(o=e("#mobile-search-form")),t.Mapbox.searchOnChange(null,o)}),e("select.houzez_search_ajax, input.houzez_search_ajax").on("change",function(){let o=e(this).closest("form");t.Mapbox.searchOnChange(null,o)}),e(".half-map-wrap").length>0&&e(".btn-apply, .half-map-search-js-btn, #auto_complete_ajax").on("click",function(o){o.preventDefault();let a=e(this).closest("form");t.Mapbox.searchOnChange(null,a)})},is_mobile:u}}(),t.Mapbox=function(){new Array;let o,a="",n=1,r=12,i="",l="",s="no",p=0,c=0,u=0,d=0,m="",g=0,h=!1,f=!1,z=!1,b=0,x=null,v=12,_=18;"undefined"!=typeof houzez_vars&&(p=parseInt(houzez_vars.is_halfmap),d=parseInt(houzez_vars.houzez_default_radius),b=parseInt(houzez_vars.auto_load_map_listings),m=houzez_vars.api_mapbox);const y=()=>t.MapboxUtils.clearClusterer(o),w=()=>t.MapboxUtils.reloadMarkers(o),k=function(){var o;e(".houzezMapType").on("click",function(o){o.preventDefault();var a=e(this).data("maptype");t.MapboxUtils.change_map_type(a)}),o=window.houzezMap,document.getElementById("listing-mapzoomin").addEventListener("click",function(){o.zoomIn(),j()}),function(e){document.getElementById("listing-mapzoomout").addEventListener("click",function(){e.zoomOut(),j()})}(window.houzezMap),e("#houzez-gmap-next").on("click",function(){t.MapboxUtils.map_next()}),e("#houzez-gmap-prev").on("click",function(){t.MapboxUtils.map_prev()})},M=function(t,o){if(1!==b)return;x&&(clearTimeout(x),x=null);const a=e("#houzez-map-message"),n=a.find(".map-info-message");if(t<o){const e=houzez_vars.map_show_some.replace("%s",t).replace("%s",o),r=houzez_vars.zoom_in_show_more;n.html(e+"<br>"+r),a.addClass("show")}else{const e=houzez_vars.map_show_all.replace("%s",o);n.html(e),a.addClass("show")}x=setTimeout(function(){a.removeClass("show")},3e3)},P=e=>{const t=e.getCenter(),o=e.getZoom();t&&null!=o&&z&&(e.setCenter(t),e.setZoom(o))},C=function(a,n){var r=e("#houzez_ajax_container"),i=e("#half-map-listing-area .page-title span"),l=e("#ajax_sort_properties").val(),s=e(".listing-view").data("layout"),p=e(".listing-view").data("css"),c=e(".listing-view").data("view");const u=n.serialize(),d={action:"houzez_half_map_listings",paged:a,sortby:l,item_layout:s,layout_css:p,layout_view:c};d.is_pagination_request=f;let m=u+"&"+e.param(d);return e.ajax({type:"GET",dataType:"json",url:t.MapboxUtils.getAjaxUrl(),data:m,beforeSend:function(){e(".houzez-map-loading").show(),r.empty().append('<div id="houzez-map-loading" class="houzez-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(a){return""!=a.query&&e('input[name="search_args"]').val(a.query),""!=a.search_uri&&e('input[name="search_URI"]').val(a.search_uri),e(".map-notfound").remove(),e(".search-no-results-found").remove(),e(".houzez-map-loading").hide(),a.total_results>0?(!0===a.getProperties&&(y(),w(),o.loaded()?(t.MapboxUtils.addMarkers(a.properties,z),P(o)):o.on("load",function(){t.MapboxUtils.addMarkers(a.properties,z),P(o)}),M(a.properties.length,a.total_results)),r.empty().html(a.propHtml),i.empty().html(a.total_results),U(),houzez_listing_lightbox(),houzez_grid_image_gallery(),houzez_grid_call_to_action(),compare_for_ajax(),t.MapboxUtils.is_mobile()||t.MapboxUtils.initInfoboxTrigger(),e('[data-bs-toggle="tooltip"]').tooltip()):(y(),w(),P(o),e("#houzez-properties-map").append('<div class="map-notfound">'+t.MapboxUtils.getNotFound()+"</div>"),r.empty().html(a.propHtml),i.empty().html(a.total_results)),!1},complete:function(){f=!1,z=!1,h=!1,e(".location-trigger").find(".icon-location-target").removeClass("icon-spin")},error:function(e,t,o){}}),!1},L=function(){if(e("#houzez-properties-map").length>0){let t=e("#radius-range-slider"),o=e("#desktop-search-form");t.on("change",t=>{e('input[name="use_radius"]').prop("checked",!0),e('input[name="ne_lat"]').val(""),e('input[name="ne_lng"]').val(""),e('input[name="sw_lat"]').val(""),e('input[name="sw_lng"]').val(""),e('input[name="zoom"]').val(""),E(null,o)})}},I=function(){if(e("#houzez-properties-map").length>0){let t=e("#fromSlider_price_range_halfmap"),o=e("#toSlider_price_range_halfmap"),a=e("#desktop-search-form");t.on("change",e=>{E(null,a)}),o.on("change",e=>{E(null,a)})}},S=function(){if(e("#houzez-properties-map").length>0){let t=e("#fromSlider_price_range_mobile"),o=e("#toSlider_price_range_mobile"),a=e("#mobile-search-form");t.on("change",e=>{E(null,a)}),o.on("change",e=>{E(null,a)})}},E=function(o=null,a=null,n=0){if(h)return;let r=a;!r&&o&&(r=o.parents("form")),r&&r.length&&(h=!0,e(".hz-halfmap-paged").val(n),t.MapboxUtils.set_url(r),C(n,r))},j=()=>{if(!b)return;z=!0;let t=e("#desktop-search-form");const a=o.getBounds();if(!a)return;const n=a.getNorthEast(),r=a.getSouthWest(),i=o.getZoom();e("#mobile-search-form.hz-mobile-overlay-search-js").length>0&&(t=e("#mobile-search-form")),e('input[name="ne_lat"]').val(n.lat),e('input[name="ne_lng"]').val(n.lng),e('input[name="sw_lat"]').val(r.lat),e('input[name="sw_lng"]').val(r.lng),e('input[name="zoom"]').val(i),e('input[name="use_radius"]').prop("checked",!1),E(null,t)},U=function(){return e(".houzez_ajax_pagination a").on("click",function(t){t.preventDefault(),b&&(f=!0),g=e(this).data("houzepagi");let o=e("#desktop-search-form");e("#mobile-search-form.apply-mobile-pagination").length>0&&(o=e("#mobile-search-form")),E(null,o,g)}),!1},T=function(){if(e("#houzez-properties-map").length>0){if(!document.getElementById("houzez-mapbox-custom-css")){const e="\n                        .mapboxgl-popup {\n                            z-index: 1000;\n                        }\n                        .mapboxgl-popup-content {\n                            background: none;\n                            padding: 0px;\n                            border-radius: 0px;\n                            box-shadow: none;\n                        }\n                        .mapboxgl-popup-close-button {\n                            color: #f1ecec;\n                            background: #000;\n                            height: 20px;\n                            padding: 0px 0px 2px 0px;\n                            width: 20px;\n                            line-height: 1px;\n                            right: -20px;\n                            border-radius: 0;\n                            font-size: 20px;\n                        }\n                        .mapboxgl-popup-close-button:hover {\n                            background: rgba(0,0,0,0.5);\n                            color: #fff;\n                        }\n                        .mapbox-marker {\n                            cursor: pointer;\n                        }\n                    ",t=document.createElement("style");t.id="houzez-mapbox-custom-css",t.innerHTML=e,document.head.appendChild(t)}let d,g,f=e("#houzez-properties-map"),z=f.data("map"),x=f.data("options"),y=0,w=0,P="mapbox://styles/mapbox/streets-v12";const C=new URLSearchParams(window.location.search);let L=C.get("lat"),I=C.get("lng");if(L&&I||(L=e('input[name="lat"]').val(),I=e('input[name="lng"]').val()),!z)return;try{d="object"==typeof z?z:JSON.parse(z),"object"==typeof x?g=x:x&&(g=JSON.parse(x))}catch(e){return}if(g&&(a=g.clusterIcon,n=g.map_cluster_enable,r=g.clusterer_zoom,i=g.closeIcon,l=g.infoWindowPlac,s=g.markerPricePins,c=parseFloat(g.default_lat),u=parseFloat(g.default_lng),v=parseFloat(g.default_zoom),_=parseFloat(g.max_zoom),P=g.mapbox_style,m=g.mapbox_access_token,y=c,w=u,L&&I&&!isNaN(parseFloat(L))&&!isNaN(parseFloat(I))&&(y=parseFloat(L),w=parseFloat(I)),g.center_lat&&g.center_lng&&(y=parseFloat(g.center_lat),w=parseFloat(g.center_lng),L=null,I=null)),!m)return void e(f).html('<p class="text-danger p-4 flex-grow-1 text-center mx-4">Mapbox API key is missing.</p>');mapboxgl.accessToken=m,o=new mapboxgl.Map({container:"houzez-properties-map",style:P,center:[w,y],zoom:v,maxZoom:_,cooperativeGestures:!0,scrollZoom:!0});const S=new MapboxLanguage({defaultLanguage:t.MapboxUtils.getMapLanguage()});o.addControl(S),o.on("error",t=>{t&&t.error&&401===t.error.status&&e(f).html('<p class="text-danger p-4 flex-grow-1 text-center mx-4">Invalid Mapbox token – check your API key.</p>')}),window.houzezMap=o,t.MapboxUtils.remove_map_loader(o),o.on("load",function(){if(d.properties&&d.properties.length>0){t.MapboxUtils.addMarkers(d.properties);let a=e("#total-results").data("total-results");a>0&&M(d.properties.length,a),L&&I||!(d.properties.length>1)||t.MapboxUtils.map_bounds(o),t.MapboxUtils.is_mobile()||t.MapboxUtils.initInfoboxTrigger()}else e("#houzez-properties-map").append('<div class="map-notfound">'+t.MapboxUtils.getNotFound()+"</div>");k(),b&&p&&(()=>{let e=!1,t=0;o.off("dragstart"),o.off("dragend"),o.off("zoomend"),o.on("dragstart",()=>{e=!0}),o.on("dragend",()=>{!h&&e&&(j(),t=Date.now()),e=!1})})()})}};return{init:function(){"object"==typeof mapboxgl&&(T(),t.MapboxUtils.initMapSearchHandlers(),t.MapboxUtils.initMapViewToggle(),function(){if(e(".hz-map-field-js").length>0){var t=houzez_vars.geo_country_limit,o=houzez_vars.geocomplete_country,a=function(e){this.$container=e};a.prototype={init:function(){this.initDomElements(),this.autocomplete()},initDomElements:function(){this.addressField=this.$container.data("address-field")},autocomplete:function(){var a=this.addressField;if(null===a)return;var n=document.getElementById(a),r=e(n).parent(),i=r.find('input[name="lat"]'),l=r.find('input[name="lng"]');let s;null!=t&&null!=o&&("UAE"==o&&(o="AE"),s=o.toLowerCase()),"undefined"!=typeof MapboxGeocoder&&(e(n).on("input",function(){var t=e(this).val();t.length<3||e.ajax({url:"https://api.mapbox.com/geocoding/v5/mapbox.places/"+encodeURIComponent(t)+".json",data:{access_token:m,autocomplete:!0,language:houzez_vars.mapboxLocale,types:"address,poi,place",country:s},success:function(t){var o=r.find(".location-suggestions");0===o.length&&(o=e('<div class="location-suggestions" style="position:absolute;z-index:1000;background:white;width:100%;border:1px solid #ccc;max-height:200px;overflow-y:auto;display:none;"></div>'),r.css("position","relative"),r.append(o)),o.empty(),t.features&&t.features.length>0?(t.features.forEach(function(t){var a=e('<div class="suggestion-item" style="padding:8px 12px;cursor:pointer;border-bottom:1px solid #eee;"></div>');a.text(t.place_name),a.data("coordinates",t.center),a.on("click",function(){e(n).val(t.place_name);var a=t.center;if(l.val(a[0]),i.val(a[1]),e('input[name="ne_lat"]').val(""),e('input[name="ne_lng"]').val(""),e('input[name="sw_lat"]').val(""),e('input[name="sw_lng"]').val(""),e('input[name="zoom"]').val(""),e('input[name="use_radius"]').prop("checked",!0),o.hide(),p){let t=e(this);E(t)}}),o.append(a)}),o.show()):o.hide()}})}),e(document).on("click",function(t){e(t.target).closest(".location-search").length||e(".location-suggestions").hide()}),r.find(".location-trigger").on("click",function(t){t.preventDefault();let o=e(this);o.find(".icon-location-target").addClass("icon-spin"),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.ajax({url:"https://api.mapbox.com/geocoding/v5/mapbox.places/"+t.coords.longitude+","+t.coords.latitude+".json",data:{access_token:m,types:"address",limit:1,language:houzez_vars.mapbox_language||"en"},success:function(a){a.features&&a.features.length>0?e(n).val(a.features[0].place_name):e(n).val(houzez_vars.current_location),l.val(t.coords.longitude),i.val(t.coords.latitude),p?E(o):o.find(".icon-location-target").removeClass("icon-spin")},error:function(){if(e(n).val(houzez_vars.current_location),l.val(t.coords.longitude),i.val(t.coords.latitude),p){let t=e(this);E(t)}}})})}))},updateCoordinate:function(t){e('input[name="lng"]').val(t[0]),e('input[name="lat"]').val(t[1]),e('input[name="ne_lat"]').val(""),e('input[name="ne_lng"]').val(""),e('input[name="sw_lat"]').val(""),e('input[name="sw_lng"]').val(""),e('input[name="zoom"]').val(""),e('input[name="use_radius"]').prop("checked",!0)}};var n=function(){var t=e(this);new a(t).init()};e(".hz-map-field-js").each(n)}}()),I(),S(),L(),t.MapboxUtils.initializeFullScreenToggle()},halfMapAjax:C,searchOnChange:E,getDefaultZoom:()=>v,getMarkerPricePins:()=>s,getInfoWindowPlac:()=>l,triggerPriceRangeSearch:I,triggerPriceRangeSearchMobile:S,triggerDistanceRangeSearch:L}}(),t.SingleAgentMapbox=function(){let o=null;const a="houzez-agent-sidebar-map",n=15,r="mapbox://styles/mapbox/streets-v11";return{init:()=>{if(e("#"+a).length<=0)return;let i=n;const l=r,s=houzez_vars.api_mapbox;if("undefined"==typeof mapboxgl)return void e("#"+a).html('<p class="text-danger p-4">Mapbox GL JS library not loaded.</p>');if(!s)return void e("#"+a).html('<p class="text-danger p-4">Mapbox access token is missing.</p>');mapboxgl.accessToken=s;const p=e("#"+a).data("lat"),c=e("#"+a).data("lng");if(""==p||""==c||isNaN(parseFloat(p))||isNaN(parseFloat(c)))e("#"+a).html('<p class="text-warning p-4">Agent location not available.</p>');else{const n=[parseFloat(c),parseFloat(p)];try{o=new mapboxgl.Map({container:a,style:l,center:n,zoom:i,cooperativeGestures:!0,scrollZoom:!0});const r=new MapboxLanguage({defaultLanguage:t.MapboxUtils.getMapLanguage()});o.addControl(r),o.on("error",t=>{t&&t.error&&401===t.error.status&&e("#"+a).html('<p class="text-danger p-4 flex-grow-1 text-center mx-4">Invalid Mapbox token – check your API key.</p>')}),o.addControl(new mapboxgl.NavigationControl,"top-right"),(new mapboxgl.Marker).setLngLat(n).addTo(o),t.MapUtils&&"function"==typeof t.MapUtils.remove_map_loader&&t.MapUtils.remove_map_loader(o)}catch(t){e("#"+a).html('<p class="text-danger p-4">Error initializing map.</p>')}}}}}(),t.SinglePropertyOverviewMapbox=function(){let o;const a="houzez-overview-listing-map",n={single_map_zoom:15,map_pin_type:"marker",markerPricePins:"no"};return{init:function(){if(e("#"+a).length<=0)return;const r=e("#"+a);let i=r.data("map"),l=r.data("options");if(!i)return;const s=l.mapbox_access_token;if(!s)return void r.html('<div class="error-wrap"><p>Mapbox API key is missing. Please add it in the theme options.</p></div>');try{if("object"==typeof i)var p=i;else p=JSON.parse(i);if("object"==typeof l)var c=l;else if(l)c=JSON.parse(l)}catch(e){return}const u="circle"===c?.map_pin_type,d=c?.markerPricePins||n.markerPricePins,m=parseInt(c?.single_map_zoom)||n.single_map_zoom;let g=n.mapbox_style;if(!p.latitude||!p.longitude)return void r.html('<div class="error-wrap"><p>Property coordinates not found</p></div>');mapboxgl.accessToken=s,g=c.mapbox_style||g,o=new mapboxgl.Map({container:a,style:g,center:[p.longitude,p.latitude],zoom:m,cooperativeGestures:!0,scrollZoom:!0});const h=new MapboxLanguage({defaultLanguage:t.MapboxUtils.getMapLanguage()});o.addControl(h),o.on("load",function(){jQuery(".houzez-map-loading").hide()}),o.on("error",e=>{e&&e.error&&401===e.error.status&&r.html('<p class="text-danger p-4 flex-grow-1 text-center mx-4">Invalid Mapbox token – check your API key.</p>')}),function(){if(!document.getElementById("houzez-mapbox-custom-css")){const e="\n                        .mapboxgl-popup {\n                            z-index: 1000;\n                        }\n                        .mapboxgl-popup-content {\n                            background: none;\n                            padding: 0px;\n                            border-radius: 0px;\n                            box-shadow: none;\n                        }\n                        .mapboxgl-popup-close-button {\n                            color: #f1ecec;\n                            background: #000;\n                            height: 20px;\n                            padding: 0px 0px 2px 0px;\n                            width: 20px;\n                            line-height: 1px;\n                            right: -20px;\n                            border-radius: 0;\n                            font-size: 20px;\n                        }\n                        .mapboxgl-popup-close-button:hover {\n                            background: rgba(0,0,0,0.5);\n                            color: #fff;\n                        }\n                        .mapbox-marker {\n                            cursor: pointer;\n                        }\n                    ",t=document.createElement("style");t.id="houzez-mapbox-custom-css",t.innerHTML=e,document.head.appendChild(t)}}(),o.on("load",function(){if(u)o.addSource("circle-source",{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:[p.longitude,p.latitude]}}}),o.addLayer({id:"circle-layer",type:"circle",source:"circle-source",paint:{"circle-radius":20,"circle-color":"#4f5962","circle-opacity":.35,"circle-stroke-width":2,"circle-stroke-color":"#4f5962","circle-stroke-opacity":.8}});else{const e=document.createElement("div");if(e.className="mapbox-custom-marker","yes"===d&&p.pricePin){e.className+=" map-marker-label";const t=document.createElement("div");t.className="gm-marker-price",t.innerHTML=p.pricePin,e.appendChild(t),p.marker_color?(e.style.backgroundColor=p.marker_color,e.style.borderColor=p.marker_color,e.style.color="#ffffff",e.style.setProperty("--triangle-color",p.marker_color)):e.style.setProperty("--triangle-color","#1DABE3")}else e.style.backgroundImage="url("+p.marker+")",e.style.width="44px",e.style.height="56px",e.style.backgroundSize="contain",e.style.backgroundRepeat="no-repeat";new mapboxgl.Marker({element:e}).setLngLat([p.longitude,p.latitude]).addTo(o)}})}}}(),t.SinglePropertyMapbox=function(){let o,a="houzez-single-listing-map";const n={},r=15,i="no";let l="mapbox://styles/mapbox/streets-v12";const s="pills-street-view",p="listing-mapzoomin",c="listing-mapzoomout",u=".houzezMapType",d=".houzez-map-loading",m='a[href="#pills-street-view"]';return{init:function(){["houzez-single-listing-map","houzez-single-listing-map-address","houzez-single-listing-map-elementor"].forEach(g=>{const h=document.getElementById(g);if(!h)return;const f=h.getAttribute("data-map"),z=h.getAttribute("data-options");if(f&&z)try{const h=JSON.parse(f),b=JSON.parse(z);if(a=g,!function(i,s){if(!mapboxgl)return!1;if(!i||!i.latitude||!i.longitude)return!1;if(l=s.mapbox_style||l,s.mapbox_access_token){mapboxgl.accessToken=s.mapbox_access_token;try{o=new mapboxgl.Map({container:a,style:l,cooperativeGestures:!0,center:[parseFloat(i.longitude),parseFloat(i.latitude)],zoom:parseInt(s?.single_map_zoom)||r,scrollZoom:!0});const p=new MapboxLanguage({defaultLanguage:t.MapboxUtils.getMapLanguage()});return o.addControl(p),o.on("error",t=>{t&&t.error&&401===t.error.status&&e("#"+a).html('<p class="text-danger p-4 flex-grow-1 text-center mx-4">Invalid Mapbox token – check your API key.</p>')}),o.addControl(new mapboxgl.NavigationControl,"top-right"),n[a]=o,!0}catch(e){return!1}}else e("#"+a).html('<p class="text-danger p-4 flex-grow-1 text-center mx-4">Mapbox API key is missing.</p>')}(h,b))return void e(d).hide();!function(e,t){if(!o)return;const a="circle"===t?.map_pin_type,n=t?.markerPricePins||i,r=[parseFloat(e.longitude),parseFloat(e.latitude)];if(a)o.on("load",()=>{o.addSource("property-circle-source",{type:"geojson",data:{type:"Feature",geometry:{type:"Point",coordinates:r}}}),o.addLayer({id:"property-circle-layer",type:"circle",source:"property-circle-source",paint:{"circle-radius":25,"circle-color":"#4f5962","circle-opacity":.35,"circle-stroke-width":2,"circle-stroke-color":"#4f5962","circle-stroke-opacity":.8}})});else{let t=document.createElement("div");if(t.className="mapbox-marker","yes"===n&&e.pricePin){t.className+=" map-marker-label";const o=document.createElement("div");o.className="gm-marker-price",o.innerHTML=e.pricePin,t.appendChild(o),e.marker_color?(t.style.backgroundColor=e.marker_color,t.style.borderColor=e.marker_color,t.style.color="#ffffff",t.style.setProperty("--triangle-color",e.marker_color)):t.style.setProperty("--triangle-color","#1DABE3")}else t.style.backgroundImage=`url(${e.marker})`,t.style.width="44px",t.style.height="56px",t.style.backgroundSize="contain",t.style.backgroundRepeat="no-repeat";new mapboxgl.Marker({element:t}).setLngLat(r).addTo(o),e.title||e.price||e.property_type}}(h,b),function(a){const r=n[a]||o;e(document).off("click.mapzoom-"+a).on("click.mapzoom-"+a,"#"+p,function(){r&&r.zoomIn()}),e(document).off("click.mapzoomout-"+a).on("click.mapzoomout-"+a,"#"+c,function(){r&&r.zoomOut()}),e(document).off("click.maptype-"+a).on("click.maptype-"+a,u,function(o){o.preventDefault();const a=e(this).data("maptype");Object.values(n).forEach(e=>{e&&e.setStyle&&t.MapboxUtils.change_map_type(a)})})}(g),e(m).on("shown.bs.tab",function(){e("#"+s).html('<p class="text-center p-5">Street View not available for Mapbox in this version.</p>')}),e(".map-media-tab").on("shown.bs.tab",function(){const t=e(e(this).attr("href")).find('[id^="houzez-single-listing-map"]');if(t.length>0){const e=t.attr("id"),o=n[e];o&&setTimeout(()=>{o.resize()},50)}else Object.values(n).forEach(e=>{e&&setTimeout(()=>{e.resize()},50)})}),t.MapboxUtils.remove_map_loader(o)}catch(t){e(d).hide()}else e(d).hide()})},getMapInstances:()=>n,getMapInstance:e=>n[e],resizeAllMaps:()=>{Object.values(n).forEach(e=>{e&&e.resize&&e.resize()})}}}(),e(document).ready(function(){t.MapboxUtils.init(),(e("#houzez-properties-map").length>0||e('input[name="search_location"]').length>0)&&t.Mapbox.init(),e("#houzez-agent-sidebar-map").length>0&&t.SingleAgentMapbox.init(),e("#houzez-overview-listing-map").length>0&&t.SinglePropertyOverviewMapbox.init(),(e("#houzez-single-listing-map").length>0||e("#houzez-single-listing-map-address").length>0||e("#houzez-single-listing-map-elementor").length>0)&&t.SinglePropertyMapbox.init()}),window.houzez=t}(jQuery);