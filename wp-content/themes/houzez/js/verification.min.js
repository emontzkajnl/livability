!function(e){"use strict";function i(){e("#document_type").on("change",function(){const i=e(this).find("option:selected");!0===i.data("requires-back")||"true"===i.attr("data-requires-back")?(e(".document-back-upload").slideDown(200),e("#verification_document_back").prop("required",!0)):(e(".document-back-upload").slideUp(200),e("#verification_document_back").prop("required",!1))}),e("#document_type").trigger("change"),e("#houzez-verification-form").on("submit",function(i){i.preventDefault(),function(i){const o=new FormData(i);o.append("action","houzez_submit_verification"),o.append("security",houzez_verification.verify_nonce||"");const t=e("#verification-messages"),n=e("#document_type").find("option:selected"),r=!0===n.data("requires-back")||"true"===n.attr("data-requires-back");t.html("");let a=!0;e("#verification_document")[0].files[0]||(window.houzez.Core.util.showError(t,houzez_verification.document_required),a=!1);r&&!e("#verification_document_back")[0].files[0]&&(window.houzez.Core.util.showError(t,houzez_verification.back_side_required),a=!1);if(!a)return;e.ajax({url:houzez_verification.ajax_url||ajaxurl,type:"POST",data:o,contentType:!1,processData:!1,beforeSend:function(){e("#submit-verification-btn").prop("disabled",!0).text(houzez_verification.submitting),e(".verification-response").remove()},success:function(i){i.success?(window.houzez.Core.util.showSuccess(t,i.data.message),e("#houzez-verification-form")[0].reset(),e(".file-upload-text").text(houzez_verification.choose_file),i.data.redirect?setTimeout(function(){window.location.href=i.data.redirect},2e3):setTimeout(function(){window.location.href=window.location.href.split("?")[0]+"?verification=true"},2e3)):window.houzez.Core.util.showError(t,i.data.message)},error:function(){window.houzez.Core.util.showError(t,houzez_verification.error)},complete:function(){e("#submit-verification-btn").prop("disabled",!1).text(houzez_verification.submit)}})}(this)}),e("#additional-info-form").on("submit",function(i){i.preventDefault(),function(i){const o=new FormData(i),t=e("#additional-info-messages"),n=e("#submit-additional-info-btn");t.html(""),e.ajax({url:houzez_verification.ajax_url||ajaxurl,type:"POST",data:o,contentType:!1,processData:!1,beforeSend:function(){n.prop("disabled",!0).html('<i class="houzez-icon icon-spinner-circle me-1"></i> '+(houzez_verification.submitting||"Submitting..."))},success:function(e){e.success?(window.houzez.Core.util.showSuccess(t,e.data.message),i.reset(),e.data.redirect&&setTimeout(function(){window.location.href=e.data.redirect},2e3)):window.houzez.Core.util.showError(t,e.data.message)},error:function(){window.houzez.Core.util.showError(t,houzez_verification.error)},complete:function(){n.prop("disabled",!1).html('<i class="houzez-icon icon-upload-button me-1"></i> '+houzez_verification.submit_additional_info)}})}(this)})}e(document).ready(function(){i()})}(jQuery);