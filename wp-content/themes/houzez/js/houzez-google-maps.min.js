!function(e){"use strict";var t=window.houzez||{};t.Maps=function(){let o,n,a=new Array,r=null,i=new Array,l=new Array,s="",p=1,c=12,d="",m="",u=0,g="no",h="",f="roadmap",y="",v="",z="",w="",_=0,b=0,k=0,I=12,x=18,C=0,M=!1,E=!1,T=!1,L=0,P=null;"undefined"!=typeof houzez_vars&&(y=houzez_vars.admin_url+"admin-ajax.php",v=houzez_vars.user_id,z=houzez_vars.not_found,w=houzez_vars.thousands_separator,_=parseInt(houzez_vars.is_halfmap),C=parseInt(houzez_vars.houzez_default_radius),L=parseInt(houzez_vars.auto_load_map_listings));const S=()=>!!window.matchMedia("(max-width: 991px)").matches||(!0===navigator.userAgentData?.mobile||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),A=function(e){const t=document.getElementById("listing-mapzoomin");t&&t.addEventListener("click",function(){var t=parseInt(e.getZoom(),10);++t>20&&(t=20),e.setZoom(t),X()})},j=function(e){const t=document.getElementById("listing-mapzoomout");t&&t.addEventListener("click",function(){var t=parseInt(e.getZoom(),10);--t<0&&(t=0),e.setZoom(t),X()})},O=function(e){return"roadmap"===e?o.setMapTypeId(google.maps.MapTypeId.ROADMAP):"satellite"===e?o.setMapTypeId(google.maps.MapTypeId.SATELLITE):"hybrid"===e?o.setMapTypeId(google.maps.MapTypeId.HYBRID):"terrain"===e&&o.setMapTypeId(google.maps.MapTypeId.TERRAIN),!1},B=function(){google.maps.event.addListener(o,"tilesloaded",function(){jQuery(".houzez-map-loading").hide()})},D=function(){0!=p&&null!=r&&r.clearMarkers()},N=function(){for(var e=0;e<i.length;e++)i[e].setMap(null);i=[]},F=function(){const e=new google.maps.LatLngBounds;for(let t=0;t<i.length;t++)i[t].position&&e.extend(i[t].position);o.fitBounds(e),google.maps.event.addListenerOnce(o,"bounds_changed",function(){const e=I;o.getZoom()>e&&o.setZoom(e)})},R=function(t,o){if(1!==L)return;P&&(clearTimeout(P),P=null);const n=e("#houzez-map-message"),a=n.find(".map-info-message");if(t<o){const e=houzez_vars.map_show_some.replace("%s",t).replace("%s",o),r=houzez_vars.zoom_in_show_more;a.html(e+"<br>"+r),n.addClass("show")}else{const e=houzez_vars.map_show_all.replace("%s",o);a.html(e),n.addClass("show")}P=setTimeout(function(){n.removeClass("show")},3e3)},Z=function(){e(".houzezMapType").on("click",function(t){t.preventDefault();var o=e(this).data("maptype");O(o)}),document.getElementById("listing-mapzoomin")&&A(o),document.getElementById("listing-mapzoomout")&&j(o),e("#houzez-gmap-next").on("click",function(){!function(){if(u++,u>i.length&&(u=1),i[u-1]){const e=i[u-1].propertyId;e&&U(e)}}()}),e("#houzez-gmap-prev").on("click",function(){!function(){if(u--,u<1&&(u=i.length),i[u-1]){const e=i[u-1].propertyId;e&&U(e)}}()})},H=async function(e,t,o=!1){let d=null,u=null;d=t.getCenter(),u=t.getZoom(),a=function(){for(;l.length>0;){l.pop().close()}};var h=function(e,t,o){t.addListener("gmp-click",function(){a(),o.open({anchor:t,map:e}),l.push(o);var n=o.getContent().getElementsByClassName("listing-thumbnail");for(let e=0;e<n.length;e++)n[e].dataset.src&&(n[e].src=n[e].dataset.src)})};const f={"&amp;":"&","&quot;":'"',"&#039;":"'","&#8217;":"’","&#038;":"&","&lt;":"<","&gt;":">","&#8216;":"‘","&#8230;":"…","&#8221;":"”","&#8211;":"â€“","&#8212;":"â€”"},y={};for(var v=0;v<e.length;v++){const t=parseFloat(e[v].latitude),o=parseFloat(e[v].longitude);if(!e[v].latitude||!e[v].longitude||isNaN(t)||isNaN(o)||t<-90||t>90||o<-180||o>180)continue;const n=`${t.toFixed(6)}_${o.toFixed(6)}`;y[n]||(y[n]={lat:t,lng:o,properties:[]}),y[n].properties.push(e[v])}for(const e in y){const o=y[e],a=new google.maps.LatLng(o.lat,o.lng),r=o.properties;let l;n.extend(a);let s="";const p=r[0],c=p.property_id.toString();let d=p.marker_color;if(r.length>1?s=`${r.length} properties at this location`:p.title&&(s=p.title.replace(/\&[\w\d\#]{2,5}\;/g,function(e){return f[e]})),"yes"==g){const e=document.createElement("div");e.className="gm-marker map-marker-label",e.dataset.id=p.property_id,e.style.position="relative",d&&(e.style.backgroundColor=d,e.style.borderColor=d,e.style.color="#ffffff");const o=document.createElement("div");if(o.className="gm-marker-price",o.innerHTML=p.pricePin,e.appendChild(o),r.length>1){const t=document.createElement("div");t.style.position="absolute",t.style.top="-8px",t.style.right="-8px",t.style.backgroundColor="#333333",t.style.color="#ffffff",t.style.borderRadius="50%",t.style.width="18px",t.style.height="18px",t.style.fontSize="10px",t.style.fontWeight="bold",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.border="2px solid #ffffff",t.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)",t.style.zIndex="1",t.textContent=r.length,e.appendChild(t)}l=new google.maps.marker.AdvancedMarkerElement({map:t,position:a,content:e,title:s}),l.propertyId=c}else{let e=p.marker;window.devicePixelRatio>1.5&&p.retinaMarker&&(e=p.retinaMarker);const o=document.createElement("div");o.style.position="relative";const n=document.createElement("img");if(n.src=e,n.style.width="44px",n.style.height="56px",o.appendChild(n),o.style.outline="none",o.style.border="none",o.style.boxShadow="none",o.addEventListener("focus",e=>{e.target.style.outline="none",e.target.style.border="none",e.target.style.boxShadow="none"}),r.length>1){const e=document.createElement("div");e.style.position="absolute",e.style.top="-5px",e.style.right="-5px",e.style.backgroundColor="#333333",e.style.color="#ffffff",e.style.borderRadius="50%",e.style.width="20px",e.style.height="20px",e.style.fontSize="11px",e.style.fontWeight="bold",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.border="2px solid #ffffff",e.style.boxShadow="0 2px 4px rgba(0,0,0,0.2)",e.textContent=r.length,o.appendChild(e)}l=new google.maps.marker.AdvancedMarkerElement({map:t,position:a,content:o,title:s}),l.propertyId=c}r.length>1&&(l.groupedProperties=r);var z=document.createElement("div");z.className="property-info-window";var w="";if(1===r.length){const e=r[0];e.thumbnail?w+='<div class="info-window-image">'+e.featured_label+'<a target="'+e.link_target+'" href="'+e.url+'"><img class="img-fluid listing-thumbnail" src="'+m+'" data-src="'+e.thumbnail+'" alt="'+e.title+'"/></a></div>':w+='<div class="info-window-image">'+e.featured_label+'<a target="'+e.link_target+'" href="'+e.url+'"><img class="img-fluid listing-thumbnail" src="'+m+'" alt="'+e.title+'"/></a></div>',w+='<div class="info-content" style="padding:10px;">',e.price&&(w+='<div class="info-window-price">'+e.price+"</div>"),w+=e.meta,e.property_type&&(w+='<div class="info-window-property-type">'+e.property_type+"</div>"),w+=e.address,w+="</div>"}else{w+='<div class="info-window-multiple-properties" style="position: relative;">',w+='<div style="max-height: 240px; overflow-y: auto; padding: 10px; scrollbar-width: thin; scrollbar-color: #ccc #f5f5f5;" class="info-window-scrollable">';for(let e=0;e<r.length;e++){const t=r[e],o=e===r.length-1;w+='<div class="info-window-property-item" data-property-id="'+t.property_id+'" style="'+(o?"":"border-bottom: 1px solid #eee; ")+'padding: 10px 0; display: flex; gap: 10px;">',w+='<div style="flex-shrink: 0;">',t.thumbnail?w+='<a target="'+t.link_target+'" href="'+t.url+'"><img class="listing-thumbnail" src="'+m+'" data-src="'+t.thumbnail+'" alt="'+t.title+'" style="width: 80px; height: 60px; object-fit: cover; border-radius: 4px;"/></a>':w+='<a target="'+t.link_target+'" href="'+t.url+'"><img class="listing-thumbnail" src="'+m+'" alt="'+t.title+'" style="width: 80px; height: 60px; object-fit: cover; border-radius: 4px;"/></a>',w+="</div>",w+='<div style="flex: 1; min-width: 0;">',w+='<h5 style="margin: 0 0 5px 0; font-size: 14px; font-weight: 600;"><a target="'+t.link_target+'" href="'+t.url+'" style="color: #333; text-decoration: none;">'+(t.title||"Property "+(e+1))+"</a></h5>",t.price&&(w+='<div style="font-weight: 600; font-size: 14px; margin-bottom: 3px;">'+t.price+"</div>"),t.property_type&&(w+='<div style="font-size: 12px; color: #666;">'+t.property_type+"</div>"),w+="</div>",w+="</div>"}w+="</div>",w+="</div>"}if(z.innerHTML=w,r.length>1){const e=document.createElement("style");e.textContent="\n                        .info-window-scrollable::-webkit-scrollbar {\n                            width: 6px;\n                        }\n                        .info-window-scrollable::-webkit-scrollbar-track {\n                            background: #f5f5f5;\n                            border-radius: 3px;\n                        }\n                        .info-window-scrollable::-webkit-scrollbar-thumb {\n                            background: #ccc;\n                            border-radius: 3px;\n                        }\n                        .info-window-scrollable::-webkit-scrollbar-thumb:hover {\n                            background: #999;\n                        }\n                    ",z.appendChild(e)}if(!document.getElementById("houzez-marker-styles")){const e=document.createElement("style");e.id="houzez-marker-styles",e.textContent='\n                        /* Remove blue border/outline from Google Maps markers */\n                        .gm-style .gm-style-iw-c,\n                        .gm-style .gm-style-iw-d,\n                        .gm-style-iw,\n                        .gm-style-iw-c,\n                        .gmp-marker-view,\n                        [role="button"]:focus,\n                        [role="button"]:active {\n                            outline: none !important;\n                            border: none !important;\n                            box-shadow: none !important;\n                        }\n                        \n                        /* Remove focus styles from advanced markers */\n                        gmp-advanced-marker,\n                        .gmp-advanced-marker {\n                            outline: none !important;\n                            border: none !important;\n                            box-shadow: none !important;\n                        }\n                        \n                        /* Remove focus styles from marker content */\n                        \n                        \n                        /* Ensure property highlighting works */\n                        .info-window-property-item.property-highlighted {\n                            background-color: #f0f8ff !important;\n                        }\n                    ',document.head.appendChild(e)}h(t,l,new google.maps.InfoWindow({content:z,maxWidth:350})),i.push(l)}if(o||F(),0!=p)try{r&&("function"==typeof r.clearMarkers?r.clearMarkers():"function"==typeof r.clear&&r.clear()),void 0!==window.markerClusterer&&(r=new window.markerClusterer.MarkerClusterer({map:t,markers:i,algorithm:new window.markerClusterer.GridAlgorithm({maxZoom:parseInt(c),gridSize:60}),renderer:{render:({count:e,position:t})=>{const o=document.createElement("div");return o.className="houzez-cluster-marker",o.style.backgroundImage=`url(${s})`,o.style.width="48px",o.style.height="48px",o.style.backgroundSize="contain",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",o.style.color="#ffffff",o.style.fontWeight="bold",o.textContent=e,new google.maps.marker.AdvancedMarkerElement({position:t,content:o})}},onClusterClick:(e,t,o)=>{const n=new google.maps.LatLngBounds;t.markers.forEach(e=>{n.extend(e.position)});const a=o.getZoom();o.fitBounds(n),t.markers.length>1&&google.maps.event.addListenerOnce(o,"bounds_changed",()=>{const e=Math.min(a+1,16);o.getZoom()>e&&o.setZoom(e)})}}))}catch(e){}},U=function(e){if(!e)return;let t=e;"string"==typeof t&&0===t.indexOf("hz-")&&(t=t.replace("hz-","")),a();const o=((e,t)=>{if(!t||!e||0===e.length)return null;const o=t.toString();for(let t=0;t<e.length;t++){const n=e[t];if(n.propertyId===o)return{marker:n,index:t};if(n.groupedProperties)for(let e=0;e<n.groupedProperties.length;e++)if(n.groupedProperties[e].property_id.toString()===o)return{marker:n,index:t,propertyIndex:e}}return null})(i,t);if(o){const e=o.marker;return e.content?e.content.click():e.click(),void 0!==o.propertyIndex&&setTimeout(()=>{W(t)},100),!0}return!1},W=function(e){const t=document.querySelector('.info-window-property-item[data-property-id="'+e+'"]');if(t){J(),t.style.transition="background-color 0.3s ease",t.classList.add("property-highlighted"),t.style.setProperty("background-color","#f0f8ff","important");const e=t.closest(".info-window-scrollable");if(e){const o=t.offsetTop;e.clientHeight,t.offsetHeight;if(0===o)e.scrollTop=0;else{const t=o-10;e.scrollTop=Math.max(0,t)}}}},J=function(){document.querySelectorAll(".property-highlighted").forEach(e=>{e.style.backgroundColor="",e.classList.remove("property-highlighted")})},q=function(){S()||e("#half-map-listing-area .hz-map-trigger").each(function(){var t=e(this).data("hz-id");"string"==typeof t?0===t.indexOf("hz-")&&(t=t.replace("hz-","")):t=e(this).data("hz-id").toString().replace(/[^\d.]/g,"");const n=t;e(this).on("mouseenter",function(){o&&U(n)}),e(this).on("mouseleave",function(){J(),a()})})},V=function(t,n){var a=e("#houzez_ajax_container"),r=e("#half-map-listing-area .page-title span"),i=e("#ajax_sort_properties").val(),l=e(".listing-view").data("layout"),s=e(".listing-view").data("css"),p=e(".listing-view").data("view");const c=n.serialize(),d={action:"houzez_half_map_listings",paged:t,sortby:i,item_layout:l,layout_css:s,layout_view:p};d.is_pagination_request=E;let m=c+"&"+e.param(d);return e.ajax({type:"GET",dataType:"json",url:y,data:m,beforeSend:function(){e(".houzez-map-loading").show(),a.empty().append('<div id="houzez-map-loading" class="houzez-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(t){if(""!=t.query&&e('input[name="search_args"]').val(t.query),""!=t.search_uri&&e('input[name="search_URI"]').val(t.search_uri),e(".map-notfound").remove(),e(".search-no-results-found").remove(),e(".houzez-map-loading").hide(),t.total_results>0){if(!0===t.getProperties){let e=o.getCenter(),n=o.getZoom();D(),N(),H(t.properties,o,T),T&&e&&n&&(o.setCenter(e),o.setZoom(n)),R(t.properties.length,t.total_results)}a.empty().html(t.propHtml),r.empty().html(t.total_results),ee(),houzez_listing_lightbox(),houzez_grid_image_gallery(),houzez_grid_call_to_action(),compare_for_ajax(),S()||q(),e('[data-bs-toggle="tooltip"]').tooltip()}else{D(),N();let n=o.getCenter(),i=o.getZoom();T&&n&&i&&(o.setCenter(n),o.setZoom(i)),A(o),j(o),e("#houzez-properties-map").append('<div class="map-notfound">'+z+"</div>"),a.empty().html(t.propHtml),r.empty().html(t.total_results)}return!1},complete:function(){E=!1,T=!1,M=!1,e(".location-trigger").find(".icon-location-target").removeClass("icon-spin")},error:function(e,t,o){}}),!1},$=function(){if(e("#houzez-properties-map").length>0){let t=e("#radius-range-slider"),o=e("#desktop-search-form");t.on("change",t=>{e('input[name="use_radius"]').prop("checked",!0),e('input[name="ne_lat"]').val(""),e('input[name="ne_lng"]').val(""),e('input[name="sw_lat"]').val(""),e('input[name="sw_lng"]').val(""),e('input[name="zoom"]').val(""),K(null,o)})}},G=function(){if(e("#houzez-properties-map").length>0){let t=e("#fromSlider_price_range_halfmap"),o=e("#toSlider_price_range_halfmap"),n=e("#desktop-search-form");t.on("change",e=>{K(null,n)}),o.on("change",e=>{K(null,n)})}},Q=function(){if(e("#houzez-properties-map").length>0){let t=e("#fromSlider_price_range_mobile"),o=e("#toSlider_price_range_mobile"),n=e("#mobile-search-form");t.on("change",e=>{K(null,n)}),o.on("change",e=>{K(null,n)})}},Y=function(t){var o=t||e("form.houzez-search-filters-js").first();o.length&&o.addClass("loading");var n=o.attr("action");if(null==n)return!0;var a,r=o.find(":input").filter(function(t,o){if(!e(o).prop("disabled")&&""!=e(o).val()&&"search_geolocation"!=e(o).attr("name")&&"search_URI"!=e(o).attr("name")&&"search_args"!=e(o).attr("name")&&"houzez_save_search_ajax"!=e(o).attr("name"))return!0}).serialize();n=null==n?"":(n.indexOf("?"),n+"?"+r),a=n,window.history.pushState({houzezTheme:!0},"",a)},K=function(t=null,o=null,n=0){if(M)return;let a=o;!a&&t&&(a=t.parents("form")),a&&a.length&&(M=!0,e(".hz-halfmap-paged").val(n),Y(a),V(n,a))},X=()=>{if(!L)return;T=!0;let t=e("#desktop-search-form");e("#mobile-search-form.hz-mobile-overlay-search-js").length>0&&(t=e("#mobile-search-form"));const n=o.getBounds();if(n){const a=n.getNorthEast(),r=n.getSouthWest(),i=o.getZoom();e('input[name="ne_lat"]').val(a.lat()),e('input[name="ne_lng"]').val(a.lng()),e('input[name="sw_lat"]').val(r.lat()),e('input[name="sw_lng"]').val(r.lng()),e('input[name="zoom"]').val(i),e('input[name="use_radius"]').prop("checked",!1),K(null,t)}},ee=function(){return e(".houzez_ajax_pagination a").on("click",function(t){t.preventDefault(),L&&(E=!0);let o=e(this).data("houzepagi"),n=e("#desktop-search-form");e("#mobile-search-form.apply-mobile-pagination").length>0&&(n=e("#mobile-search-form")),K(null,n,o)}),!1},te=async function(){if(e("#houzez-properties-map").length>0){let a,r,i=e("#houzez-properties-map"),l=i.data("map"),u=i.data("options");const y=new URLSearchParams(window.location.search);let v=y.get("lat"),z=y.get("lng");if(v&&z||(v=e('input[name="lat"]').val(),z=e('input[name="lng"]').val()),!l)return;try{a="object"==typeof l?l:JSON.parse(l),"object"==typeof u?r=u:u&&(r=JSON.parse(u))}catch(e){return}if(r){s=r.clusterIcon,p=r.map_cluster_enable,c=r.clusterer_zoom,d=r.closeIcon,m=r.infoWindowPlac,g=r.markerPricePins,f=r.map_type,h=r.googlemap_style,b=parseFloat(r.default_lat),k=parseFloat(r.default_lng),I=parseFloat(r.default_zoom),x=parseFloat(r.max_zoom),v&&z&&!isNaN(parseFloat(v))&&!isNaN(parseFloat(z))&&(b=parseFloat(v),k=parseFloat(z)),r.center_lat&&r.center_lng&&(b=parseFloat(r.center_lat),k=parseFloat(r.center_lng));var t={zoom:I,maxZoom:x,disableDefaultUI:!0,scrollwheel:!1,center:new google.maps.LatLng(b,k),mapId:r.mapId}}if(t=function(e){switch(f){case"hybrid":e.mapTypeId=google.maps.MapTypeId.HYBRID;break;case"terrain":e.mapTypeId=google.maps.MapTypeId.TERRAIN;break;case"satellite":e.mapTypeId=google.maps.MapTypeId.SATELLITE;break;default:e.mapTypeId=google.maps.MapTypeId.ROADMAP}return e}(t),o=new google.maps.Map(document.getElementById("houzez-properties-map"),t),n=new google.maps.LatLngBounds,B(),a.properties&&a.properties.length>0){await H(a.properties,o),S()||q();let t=e("#total-results").data("total-results");t>0&&R(a.properties.length,t)}else{t={center:new google.maps.LatLng(b,k),zoom:I,maxZoom:x,disableDefaultUI:!0,scrollwheel:!1,mapId:r.mapId};o=new google.maps.Map(document.getElementById("houzez-properties-map"),t),jQuery(".houzez-map-loading").hide()}Z(),L&&_&&(()=>{let e=!1,t=0;google.maps.event.clearListeners(o,"idle"),google.maps.event.clearListeners(o,"dragend"),google.maps.event.clearListeners(o,"dragstart"),google.maps.event.clearListeners(o,"zoom_changed"),google.maps.event.addListener(o,"dragstart",function(){e=!0}),google.maps.event.addListener(o,"dragend",function(){!M&&e?(X(),t=Date.now(),e=!1):e=!1})})()}};return{init:async function(){"object"==typeof google&&"object"==typeof google.maps&&(te(),ee(),e("#ajax_sort_properties").on("change",function(){let t=e("#desktop-search-form");e(this).hasClass("mobile-sortby")&&(t=e("#mobile-search-form")),K(null,t)}),e("select.houzez_search_ajax, input.houzez_search_ajax").on("change",function(){var t=e(this).closest("form");K(null,t)}),e(".half-map-wrap").length>0&&e(".btn-apply, .half-map-search-js-btn, #auto_complete_ajax").on("click",function(t){t.preventDefault();let o=e(this).closest("form");K(null,o)}),e("#houzez-btn-map-view").on("click",function(t){t.preventDefault(),e("#half-map-listing-area, .listing-wrap").hide(),e("#map-view-wrap").show(),e("#mobile-search-form").addClass("hz-mobile-overlay-search-js"),google.maps.event.trigger(o,"resize"),F()}),e("#houzez-btn-listing-view").on("click",function(o){o.preventDefault(),e("#map-view-wrap").hide(),e("#half-map-listing-area, .listing-wrap").show(),e("#mobile-search-form").removeClass("hz-mobile-overlay-search-js"),e(".hz-item-gallery-js").removeClass("houzez-gallery-loaded"),window.setTimeout(function(){t.Core&&"function"==typeof t.Core.reinitializeAjaxFunctions&&t.Core.reinitializeAjaxFunctions()},100)}),function(){if(e(".hz-map-field-js").length>0){var t=houzez_vars.geo_country_limit,o=houzez_vars.geocomplete_country,n=function(e){this.$container=e};n.prototype={init:function(){this.initDomElements(),this.autocomplete()},initDomElements:function(){this.addressField=this.$container.data("address-field")},autocomplete:function(){var n=this,a=this.addressField;if(null!==a){var r=document.getElementById(a),i=new google.maps.places.Autocomplete(r,{types:["geocode","establishment"]});0!=t&&""!=o&&("UAE"==o&&(o="AE"),i.setComponentRestrictions({country:[o]})),google.maps.event.addListener(i,"place_changed",function(){var t=i.getPlace(),o=new google.maps.LatLng(t.geometry.location.lat(),t.geometry.location.lng());n.updateCoordinate(o),_&&(r=e(r),K(r))})}},updateCoordinate:function(t){e('input[name="lat"]').val(t.lat()),e('input[name="lng"]').val(t.lng()),e('input[name="ne_lat"]').val(""),e('input[name="ne_lng"]').val(""),e('input[name="sw_lat"]').val(""),e('input[name="sw_lng"]').val(""),e('input[name="zoom"]').val(""),e('input[name="use_radius"]').prop("checked",!0)}};var a=function(){var t=e(this);new n(t).init()};e(".hz-map-field-js").each(a),e(".location-trigger").on("click",function(t){t.preventDefault();let o=e(this),n=o.parents(".location-search").find("input.search_location_js");o.find(".icon-location-target").addClass("icon-spin"),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){let a=new google.maps.Geocoder,r=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);a.geocode({location:r},function(a,r){r===google.maps.GeocoderStatus.OK&&a[0]?n.val(a[0].formatted_address):n.val(houzez_vars.current_location),e('input[name="lat"]').val(t.coords.latitude),e('input[name="lng"]').val(t.coords.longitude),e('input[name="ne_lat"]').val(""),e('input[name="ne_lng"]').val(""),e('input[name="sw_lat"]').val(""),e('input[name="sw_lng"]').val(""),e('input[name="zoom"]').val(""),e('input[name="use_radius"]').prop("checked",!0),_?K(o):o.find(".icon-location-target").removeClass("icon-spin")})})})}}()),G(),Q(),$(),e("#houzez-gmap-full").on("click",function(){var t=e(this);t.hasClass("active")?(t.removeClass("active"),t.parents(".map-wrap").removeClass("houzez-fullscreen-map")):(t.parents(".map-wrap").addClass("houzez-fullscreen-map"),t.addClass("active"))})},addMarkers:H,clearClusterer:D,reloadMarkers:N,mapBounds:F,halfMapAjax:V,setUrl:Y,searchOnChange:K,changeMapType:O,initInfoboxTrigger:q,removeMapLoader:B,createMapCircle:(e,t,{strokeColor:o="#4f5962",strokeOpacity:n=.8,strokeWeight:a=2,fillColor:r="#4f5962",fillOpacity:i=.35,radius:l=300,...s}={})=>{const p={strokeColor:o,strokeOpacity:n,strokeWeight:a,fillColor:r,fillOpacity:i,radius:l,...s,map:e,center:t};return new google.maps.Circle(p)},createStandardMarker:async(e,t,o,{propertyId:n=(t&&t.property_id?t.property_id.toString():null),...a}={})=>{if(!t)return null;let r=t.marker;window.devicePixelRatio>1.5&&t.retinaMarker&&(r=t.retinaMarker);let i="";if(t.title){const e={"&amp;":"&","&quot;":'"',"&#039;":"'","&#8217;":"’","&#038;":"&","&lt;":"<","&gt;":">","&#8216;":"‘","&#8230;":"…","&#8221;":"”","&#8211;":"â€“","&#8212;":"â€”"};i=t.title.replace(/\&[\w\d\#]{2,5}\;/g,t=>e[t])}const l=document.createElement("div");l.style.position="relative";const s=document.createElement("img");s.src=r,s.style.width="44px",s.style.height="56px",l.appendChild(s);const p=new google.maps.marker.AdvancedMarkerElement({map:e,position:o,content:l,title:i,...a});return p.propertyId=n,p},createPricePin:async(e,t,o)=>{if(!t)return null;const n=document.createElement("div");n.className="gm-marker map-marker-label",n.dataset.id=t.property_id;const a=document.createElement("div");a.className="gm-marker-price",a.innerHTML=t.pricePin,n.appendChild(a);const r=new google.maps.marker.AdvancedMarkerElement({map:e,position:o,content:n});return r.propertyId=t.property_id.toString(),r},triggerPriceRangeSearch:G,triggerPriceRangeSearchMobile:Q,triggerDistanceRangeSearch:$}}(),t.SingleAgentMap=function(){let t=null;return{init:async()=>{if(e("#houzez-agent-sidebar-map").length<=0)return;const o=e("#houzez-agent-sidebar-map").data("lat"),n=e("#houzez-agent-sidebar-map").data("lng");if(""!=o&&""!=n){const e=new google.maps.LatLng(o,n),a={center:e,zoom:15,disableDefaultUI:!0,scrollwheel:!1,mapId:"HOUZEZ_MAP_ID"};t=new google.maps.Map(document.getElementById("houzez-agent-sidebar-map"),a);const r=new google.maps.marker.PinElement({background:"#1DABE3",borderColor:"#FFFFFF",glyphColor:"#FFFFFF"});new google.maps.marker.AdvancedMarkerElement({map:t,position:e,content:r.element})}}}}(),t.SinglePropertyOverviewMap=function(){let o,n=null;return{init:async()=>{if(e("#houzez-overview-listing-map").length<=0)return;let a,r,i;const l=e("#houzez-overview-listing-map");let s=l.data("map"),p=l.data("options");if(!s)return;let c=15,d="",m=!1,u="marker",g="no",h="HOUZEZ_MAP_ID";if(p)try{a="object"==typeof p?p:JSON.parse(p)}catch(e){}try{"object"==typeof s||(s=JSON.parse(s))}catch(e){return}if(!s.latitude||!s.longitude)return;if(a&&(i=a.closeIcon,r=a.infoWindowPlac,g=a.markerPricePins,u=a.map_pin_type,d=a.googlemap_style,h=a.mapId||"HOUZEZ_MAP_ID","circle"==u&&(m=!0),a.single_map_zoom>0&&(c=parseInt(a.single_map_zoom)),d))try{"string"==typeof d&&(d=JSON.parse(d))}catch(e){d=""}const f=new google.maps.LatLng(s.latitude,s.longitude),y={center:f,zoom:parseInt(c),disableDefaultUI:!1,scrollwheel:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,mapId:h};if(o=new google.maps.Map(document.getElementById("houzez-overview-listing-map"),y),m)t.Maps.createMapCircle(o,f);else{const{AdvancedMarkerElement:e}=google.maps.marker;if("yes"===g&&s.pricePin){const t=document.createElement("div");t.className="gm-marker map-marker-label",t.dataset.id=s.property_id||s.post_id,s.marker_color&&(t.style.backgroundColor=s.marker_color,t.style.borderColor=s.marker_color,t.style.color="#ffffff");const a=document.createElement("div");a.className="gm-marker-price",a.innerHTML=s.pricePin,t.appendChild(a),n=new e({map:o,position:f,content:t,title:s.title||""})}else{let t=s.marker;window.devicePixelRatio>1.5&&s.retinaMarker&&(t=s.retinaMarker);const a=document.createElement("div");a.style.position="relative";const r=document.createElement("img");r.src=t,r.style.width="44px",r.style.height="56px",a.appendChild(r),n=new e({map:o,position:f,content:a,title:s.title||""})}}}}}(),t.SinglePropertyMap=function(){let o=null,n=null,a=0,r=null;const i=({map:e,zoomInBtnId:t,zoomOutBtnId:o,mapTypeSelector:n})=>{},l=async({map:e,propertyData:o,position:n,showCircle:a=!1,markerPricePins:r="no"})=>{if(e&&n)if(a)t.Maps.createMapCircle(e,n);else{const{AdvancedMarkerElement:t}=google.maps.marker;let a;if("yes"===r&&o.pricePin){const r=document.createElement("div");r.className="gm-marker map-marker-label",r.dataset.id=o.property_id,o.marker_color&&(r.style.backgroundColor=o.marker_color,r.style.borderColor=o.marker_color,r.style.color="#ffffff");const i=document.createElement("div");i.className="gm-marker-price",i.innerHTML=o.pricePin,r.appendChild(i),a=new t({map:e,position:n,content:r,title:o.title})}else{let r=o.marker;window.devicePixelRatio>1.5&&o.retinaMarker&&(r=o.retinaMarker);const i=document.createElement("div");i.style.position="relative";const l=document.createElement("img");l.src=r,l.style.width="44px",l.style.height="56px",i.appendChild(l),a=new t({map:e,position:n,content:i,title:o.title})}a&&a.addListener("gmp-click",()=>{})}},s=({map:t,position:o,streetViewTabSelector:r,streetViewContainerId:i})=>{if(!t||!o)return;const l=e(r);0!==l.length&&l.on("shown.bs.tab",()=>{a++;const e=document.getElementById(i);if(!e)return;const t={position:o,pov:{heading:34,pitch:10}};a<=1?n=new google.maps.StreetViewPanorama(e,t):n&&n.setPosition(o)})},p=()=>{["houzez-single-listing-map","houzez-single-listing-map-address","houzez-single-listing-map-elementor"].forEach(t=>{const n=document.getElementById(t);if(n)try{const e=n.getAttribute("data-map"),a=n.getAttribute("data-options");if(!e)return;const p="object"==typeof e?e:JSON.parse(e);(async({mapContainerId:e="houzez-single-listing-map",streetViewContainerId:t="pills-street-view",zoomInBtnId:n="listing-mapzoomin",zoomOutBtnId:a="listing-mapzoomout",mapTypeSelector:p=".houzezMapType",streetViewTabSelector:c='a[href="#pills-street-view"]',propertyData:d=null,mapOptions:m={}}={})=>{const u=document.getElementById(e);if(!u)return;if(!d)try{const e=u.getAttribute("data-map");e&&(d="object"==typeof e?e:JSON.parse(e))}catch(e){return}if(0===Object.keys(m).length)try{const e=u.getAttribute("data-options");e&&(m="object"==typeof e?e:JSON.parse(e))}catch(e){}if(!d||!d.latitude||!d.longitude)return;r=new google.maps.LatLng(d.latitude,d.longitude);const g={center:r,zoom:parseInt(m.single_map_zoom)||15,disableDefaultUI:!1,scrollwheel:!1,mapId:m.mapId};switch(m.mapType){case"hybrid":g.mapTypeId=google.maps.MapTypeId.HYBRID;break;case"terrain":g.mapTypeId=google.maps.MapTypeId.TERRAIN;break;case"satellite":g.mapTypeId=google.maps.MapTypeId.SATELLITE;break;default:g.mapTypeId=google.maps.MapTypeId.ROADMAP}o=new google.maps.Map(u,g),i({map:o,zoomInBtnId:n,zoomOutBtnId:a,mapTypeSelector:p}),await l({map:o,propertyData:d,position:r,showCircle:"circle"===m.map_pin_type,markerPricePins:m.markerPricePins}),s({map:o,position:r,streetViewTabSelector:c,streetViewContainerId:t})})({mapContainerId:t,propertyData:p,mapOptions:a?"object"==typeof a?a:JSON.parse(a):{}}).catch(e=>{})}catch(t){e(".houzez-map-loading").hide()}})};return{init:p,loadMapFromDOM:p}}(),window.houzez=t}(jQuery);