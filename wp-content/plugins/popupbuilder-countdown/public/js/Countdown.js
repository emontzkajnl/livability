function SGPBCountdown()
{this.id;this.interval;this.repetitiveInterval=false;this.countdownCalendar;this.timezone;this.content=' ';this.closeType='on';this.countdownType;this.showSeconds=false;this.clockFace='DailyCounter';this.language='English';this.clock='';this.params=[];this.isChanged=false;}
SGPBCountdown.prototype.setId=function(id)
{this.id=id;};SGPBCountdown.prototype.getId=function()
{return this.id;};SGPBCountdown.prototype.setInterval=function(interval)
{this.interval=interval;};SGPBCountdown.prototype.setExtraInterval=function()
{var countdownMode=jQuery('.sgpb-countdown-date-format-from-date:checked').val();var repetitiveMode=jQuery('#sgpb-countdown-repetitive-timer').is(':checked');if(countdownMode=='input'){var dates={};jQuery('.sgpb-countdown-date-input').each(function(){var value=jQuery(this).val();var type=jQuery(this).data('type');dates[type]=parseInt(value);});var dateObj=new Date();dateObj.setDate(dateObj.getDay()+dates.days);dateObj.setDate(dateObj.getHours()+dates.hours);dateObj.setDate(dateObj.getMinutes()+dates.minutes);var seconds=dates.minutes*60*1000+dates.hours*60*60*1000+dates.days*24*60*60*1000;var currentDateObj=new Date();var currentDateObj=new Date(currentDateObj.getTime()+seconds);var day=currentDateObj.getDate();var month=currentDateObj.getMonth()+1;var year=currentDateObj.getFullYear();var hours=currentDateObj.getHours();var minutes=currentDateObj.getMinutes();var seconds=currentDateObj.getSeconds();var remainsSeconds=this.setCounterTime(year+'/'+month+'/'+day+' '+hours+':'+minutes+':'+seconds);this.repetitiveInterval=remainsSeconds;if(SgpbCountdownParams.init=='adminInit'){this.setInterval(remainsSeconds)}
jQuery('#sgpb-countdown-repetitive-seconds').val(remainsSeconds);}
else{if(countdownMode=='input'){var dates={};jQuery('.sgpb-countdown-date-input').each(function(){var value=jQuery(this).val();var type=jQuery(this).data('type');dates[type]=parseInt(value);});var dateObj=new Date();dateObj.setDate(dateObj.getDay()+dates.days);dateObj.setDate(dateObj.getHours()+dates.hours);dateObj.setDate(dateObj.getMinutes()+dates.minutes);var seconds=dates.minutes*60*1000+dates.hours*60*60*1000+dates.days*24*60*60*1000;var currentDateObj=new Date();var currentDateObj=new Date(currentDateObj.getTime()+seconds);var day=currentDateObj.getDate();var month=currentDateObj.getMonth()+1;var year=currentDateObj.getFullYear();var hours=currentDateObj.getHours();var minutes=currentDateObj.getMinutes();var seconds=currentDateObj.getSeconds();var remainsSeconds=this.setCounterTime(year+'/'+month+'/'+day+' '+hours+':'+minutes+':'+seconds);if(SgpbCountdownParams.init=='adminInit'){this.setInterval(remainsSeconds);}}}};SGPBCountdown.prototype.getExtraInterval=function()
{return this.repetitiveInterval;};SGPBCountdown.prototype.setParams=function()
{var popupId=this.getId();var params=jQuery('.sgpb-countdown-js-'+popupId).data('params');this.params=params;};SGPBCountdown.prototype.getParams=function()
{return this.params;};SGPBCountdown.prototype.setContent=function(content)
{this.content=content;};SGPBCountdown.prototype.setCloseType=function(closeType)
{this.closeType=closeType;};SGPBCountdown.prototype.setCountdownType=function(countdownType)
{this.countdownType=countdownType;};SGPBCountdown.prototype.setLanguage=function(language)
{this.language=language;};SGPBCountdown.prototype.setClock=function(clock)
{this.clock=clock;};SGPBCountdown.prototype.getClock=function()
{return this.clock;};SGPBCountdown.prototype.setClockFace=function(countType)
{countType=Number(countType);var that=this;switch(countType){case 1:that.clockFace='DailyCounter';that.showSeconds=true;break;case 2:that.clockFace='DailyCounter';that.showSeconds=false;break;}};SGPBCountdown.prototype.render=function()
{var that=this;var params=that.getParams();var popupId=that.getId();var interval=this.interval;if(interval>'-61'&&interval<'-1'){interval=Math.abs(interval);}
this.setClockFace(this.countdownType);this.clock=jQuery('.sgpb-flipclock-js-'+popupId).FlipClock(interval,{clockFace:that.clockFace,autoStart:true,countdown:true,showSeconds:this.showSeconds,language:this.language,callbacks:{start:function(){},stop:function(){if(params.repetitiveTimer){that.resetCounter(popupId);that.setInterval(params.repetitiveTimer);that.render();}
else{SGPBPopup.closePopupById(params.id);}}}});this.setIntialWidthCountdown();this.countdownScaling();this.setClock(this.clock);jQuery(window).bind('sgpbPopupReload',function(){that.countdownScaling();});jQuery('.sgpb-content-'+popupId).css('min-width','300px !important');};SGPBCountdown.prototype.setIntialWidthCountdown=function()
{var countdownWrapper=jQuery('#sgpb-popup-dialog-main-div-wrapper .sgpb-countdown-wrapper');if(!countdownWrapper.length){return false;}
countdownWrapper.attr('data-initial-width',countdownWrapper.width());};SGPBCountdown.prototype.countdownScaling=function()
{var popupId=this.getId();var mainDiv=jQuery('.sgpb-content-'+popupId).parent().parent();if(mainDiv.length!=0){var countdownWrapper=mainDiv.find('.sgpb-countdown-wrapper');var screenWidth=countdownWrapper.parentsUntil('#sgpb-popup-dialog-main-div').width();var initialWidth=countdownWrapper.data('initial-width');}
else if(jQuery('.special-options-content').length!=0){var screenWidth=jQuery('.special-options-content').width();}
var popupWrapper=mainDiv.find('.sgpb-counts-content').width();var countdownPopupWrapper=document.getElementById('sgpb-clear-countdown');if(!countdownPopupWrapper){return;}
var countdownCurrentWidth=countdownPopupWrapper.getBoundingClientRect().width;var loadedContentWidth=mainDiv.width();if(countdownCurrentWidth!=0&&loadedContentWidth>countdownCurrentWidth&&countdownCurrentWidth<=initialWidth){mainDiv.find('.sgpb-countdown-wrapper').css({'transform':'scale(1, 1)','transform-origin':'left','-webkit-transform-origin':'left','-moz-transform-origin':'left','overflow':'hidden'});}
if(screenWidth<popupWrapper){var scaleDegree=screenWidth/popupWrapper;var setting=jQuery('.sgpb-countdown-wrapper').css('float');mainDiv.find('.sgpb-countdown-wrapper').css({'transform':'scale('+scaleDegree+', 1)','transform-origin':setting,'-webkit-transform-origin':setting,'-moz-transform-origin':setting,'overflow':'hidden'});}};SGPBCountdown.prototype.resetAdminCounter=function()
{var that=this;var dates={};jQuery('.sgpb-countdown-date-input').each(function(){var value=jQuery(this).val();var type=jQuery(this).data('type');dates[type]=parseInt(value);});var dateObj=new Date();dateObj.setDate(dateObj.getDay()+dates.days);dateObj.setDate(dateObj.getHours()+dates.hours);dateObj.setDate(dateObj.getMinutes()+dates.minutes);var seconds=dates.minutes*60*1000+dates.hours*60*60*1000+dates.days*24*60*60*1000;that.setExtraInterval();var currentDateObj=new Date();var currentDateObj=new Date(currentDateObj.getTime()+seconds);var day=currentDateObj.getDate();var month=currentDateObj.getMonth()+1;var year=currentDateObj.getFullYear();var hours=currentDateObj.getHours();var minutes=currentDateObj.getMinutes();var seconds=currentDateObj.getSeconds();var remainsSeconds=that.setCounterTime(year+'/'+month+'/'+day+' '+hours+':'+minutes+':'+seconds);that.isChanged=true;that.setInterval(remainsSeconds);that.render();};SGPBCountdown.prototype.adminInit=function()
{var that=this;this.datePicker();this.fixedPositionSelection();this.colorPicker();jQuery("[name='sgpb-countdown-language']").bind('change',function(){that.setLanguage(jQuery(this).val());that.render();});jQuery('.sgpb-countdown-date-format-from-date').bind('change',function(){that.setExtraInterval();});jQuery("[name='sgpb-countdown-type']").bind('change',function(){that.setCountdownType(jQuery(this).val());that.render();});this.countdownCalendar.bind('change',function(){var seconds=that.setCounterTime();that.setExtraInterval();that.setInterval(seconds);that.render();});jQuery("[name='sgpb-countdown-timezone']").bind('change',function(){var seconds=that.setCounterTime();that.setExtraInterval(seconds);that.setInterval(seconds);that.render();});jQuery("[name='sgpb-countdown-repetitive-timer']").bind('change',function(){that.resetAdminCounter();});jQuery('.sgpb-countdown-date-input').bind('change',function(){that.resetAdminCounter();});this.trigger();this.render();};SGPBCountdown.prototype.setCounterTime=function(dateString)
{var calendarValue=dateString||jQuery('#sgpb-date-picker').val()+':00';var selectedTimezone=jQuery("[name='sgpb-countdown-timezone']").val();var selectedDateTime=new Date().toLocaleString('en-US',{timeZone:selectedTimezone});var dateTime=new Date(selectedDateTime).valueOf();var timeNow=Math.floor(dateTime/1000);var seconds=Math.floor(new Date(calendarValue.replace(/-/g,"/")).getTime()/1000)-timeNow;if(seconds<0){if(seconds>'-61'&&seconds<'-1'){seconds=Math.abs(seconds);}
else{seconds=0;}}
return seconds;};SGPBCountdown.prototype.trigger=function()
{jQuery("[name='sgpb-countdown-language']").trigger('change');jQuery("[name='sgpb-countdown-type']").trigger('change');this.countdownCalendar.trigger('change');};SGPBCountdown.prototype.datePicker=function()
{var that=this;this.countdownCalendar=jQuery('#sgpb-date-picker').datetimepicker({format:'Y-m-d H:i',minDate:0});};SGPBCountdown.prototype.getCurrentRemainsSeconds=function()
{var params=this.getParams();if(typeof params=='undefined'){return;}
var calendarValue=params.dueDate.replace(/-/g,'/');var selectedTimezone=params.timezone;var selectedDateTime=new Date().toLocaleString('en-US',{timeZone:selectedTimezone});var dateTime=new Date(selectedDateTime).valueOf();var timeNow=Math.floor(dateTime/1000);var seconds=Math.floor(new Date(calendarValue).getTime()/1000)-timeNow;if(seconds<0){seconds=0;}
return seconds;};SGPBCountdown.prototype.init=function()
{var params=this.getParams();if(typeof params=='undefined'){return;}
var seconds=this.getCurrentRemainsSeconds();this.setInterval(seconds);this.setCountdownType(params.type);this.setLanguage(params.language);this.render();};SGPBCountdown.prototype.allowToOpen=function(id)
{this.setId(id);this.setParams();var canBeOpened=true;var seconds=this.getCurrentRemainsSeconds();if(seconds==0){canBeOpened=false;}
if(typeof SgpbCountdownParams!='undefined'){if(SgpbCountdownParams['id']==id){if(SgpbCountdownParams['repetitiveTimer']){canBeOpened=true;}}}
if(typeof params!='undefined'&&typeof params.repetitiveTimer!='undefined'&&params.repetitiveTimer){canBeOpened=true;}
return canBeOpened;};SGPBCountdown.prototype.colorPicker=function()
{var that=this;var colorPicker=jQuery('.sgpb-color-picker');if(!colorPicker.length){return false;}
colorPicker.wpColorPicker({change:function(){var colorPickerElement=jQuery(this);that.changeColor(colorPickerElement);}});jQuery('.wp-picker-holder').bind('click',function(){var selectedInput=jQuery(this).prev().find('.sgpb-color-picker');that.changeColor(selectedInput);});};SGPBCountdown.prototype.changeColor=function(element)
{var selectedName=element.attr("name");var elementVal=element.val();if(selectedName=='sgpb-counter-text-color'){jQuery('#sgpb-counts-text').remove();jQuery('body').append('<style id="sgpb-counts-text">.sgpb-counts-content.sgpb-flipclock-js-'+SgpbCountdownParams.id+'.flip-clock-wrapper ul li a div div.inn { color: '+elementVal+'; }</style>');}
if(selectedName=='sgpb-counter-background-color'){jQuery('#sgpb-counts-style').remove();jQuery('body').append('<style id="sgpb-counts-style">.sgpb-counts-content.sgpb-flipclock-js-'+SgpbCountdownParams.id+'.flip-clock-wrapper ul li a div div.inn { background-color: '+elementVal+'; }</style>');}
if(selectedName=='sgpb-counter-labels-color'){jQuery('body').append('<style id="sgpb-counts-style">.sgpb-counts-content.sgpb-flipclock-js-'+SgpbCountdownParams.id+'.flip-clock-wrapper .flip-clock-divider .flip-clock-label { color: '+elementVal+'; }</style>');}
if(selectedName=='sgpb-counter-divider-color'){jQuery('body').append('<style id="sgpb-counts-style">.sgpb-counts-content.sgpb-flipclock-js-'+SgpbCountdownParams.id+'.flip-clock-wrapper .flip-clock-divider .flip-clock-dot { background-color: '+elementVal+'; }</style>');}};SGPBCountdown.prototype.fixedPositionSelection=function()
{var that=this;jQuery('.js-countdown-position-style').bind('click',function(){var sgValue=jQuery(this).data('sgvalue');jQuery('.js-countdown-position-style').css('opacity','0.4');jQuery(this).css('opacity','1');jQuery('.js-countdown-position').val(sgValue);});jQuery('.js-countdown-position-style').bind('mouseover',function(){var sgValue=jQuery(this).data('sgvalue');jQuery('.js-countdown-position-style').css('opacity','0.4');jQuery(this).css('opacity','1');jQuery('.js-countdown-position-style').each(function(){if(jQuery(this).attr('data-sgvalue')==jQuery('.js-countdown-position').val())
jQuery(this).css('opacity','1');});});jQuery('.js-countdown-position-style').bind('mouseout',function(){if(jQuery('.js-countdown-position-style').attr('data-sgvalue')!==jQuery('.js-countdown-position').val()){jQuery(this).css('opacity','0.4');}
jQuery('.js-countdown-position-style').each(function(){if(jQuery(this).attr('data-sgvalue')==jQuery('.js-countdown-position').val()){jQuery(this).css('opacity','1');}});});jQuery('.js-countdown-position-style').each(function(){if(jQuery(this).attr('data-sgvalue')==jQuery('.js-countdown-position').val()){jQuery(this).css('opacity','1');}});};SGPBCountdown.prototype.resetCounter=function(popupId)
{var that=this;var data={action:'sgpb_countdown_reset_counter',nonce:SGPB_JS_PARAMS.nonce,popupId:popupId};jQuery.post(SGPB_JS_PARAMS.ajaxUrl,data,function(res){});};jQuery(document).ready(function(){var objCountdown=new SGPBCountdown();if(typeof SgpbCountdownParams=='undefined'){return false;}
if(SgpbCountdownParams['init']=='init'){sgAddEvent(window,'sgpbDidOpen',function(e){var args=e.detail;var popupId=parseInt(args.popupId);objCountdown.setId(popupId);objCountdown.setParams();objCountdown[SgpbCountdownParams['init']]();});}
else{objCountdown.setId(SgpbCountdownParams.id);objCountdown.setParams();objCountdown[SgpbCountdownParams['init']]();}});