function SGPBContactForm()
{this.submissionPopupId=0;this.newWindow=null;this.init();}
SGPBContactForm.cookieName='SGPBContactForm';SGPBContactForm.prototype.init=function()
{this.makeContactTitleFieldsRequired();this.formSubmission();this.messageResize();};SGPBContactForm.prototype.formSubmission=function()
{var cfForms=jQuery('form.sgpb-contact-form-form');if(!cfForms.length){return false;}
var that=this;cfForms.each(function(){var form=jQuery(this);var formValidateJson=form.attr('data-validate-json');var validateObj=jQuery.parseJSON(formValidateJson);var currentSubmitHandler=that.submitHandlers;var submitArgs={submitionForm:form,that:that};currentSubmitHandler=currentSubmitHandler.bind(submitArgs);validateObj.submitHandler=currentSubmitHandler;that.validateMessages();form.validate(validateObj);});};SGPBContactForm.prototype.validateMessages=function()
{jQuery.validator.setDefaults({errorPlacement:function(error,element){var currentElement=jQuery(element);var currentSubscriptionPlusForm=currentElement.parents('.sgpb-contact-form-form').first();if(currentSubscriptionPlusForm.length){var formId=currentSubscriptionPlusForm.data('popup-id');var currentFieldName=currentElement.attr('name');if(currentElement.data('field-type')=='customMultiple'){jQuery('.sgpb-contact-form-'+formId+' [name="'+currentFieldName+'"]').parent().next('.sgpb-custom-field-error-message').html(error);return true;}
if(currentFieldName.indexOf('[]')>0){currentFieldName=currentFieldName.substring(0,currentFieldName.length-2);}
jQuery('.sgpb-contact-form-'+formId+' .sgpb-form-field-'+currentFieldName+'-error').html(error);}}});};SGPBContactForm.prototype.submitHandlers=function()
{var additionalPopupParams={};var form=this.submitionForm;var popupId=jQuery(form).data('popup-id');var popupOptions=SGPBPopup.getPopupOptionsById(popupId);var formSerializedData=form.serialize();var firstNameValue='';var subjectValue='';var firstNameInput=jQuery('.sgpb-contact-form-'+popupId+' .sgpb-field-firstname-wrapper input').first();var subjectInput=jQuery('.sgpb-contact-form-'+popupId+' .sgpb-field-subject-wrapper input').first();var submitButton=jQuery('.sgpb-contact-form-'+popupId+' .sgpb-field-submit-wrapper input').first();var emailValue=jQuery('.sgpb-contact-form-'+popupId+' .sgpb-field-email-wrapper input').first().val();var textareaValue=jQuery('.sgpb-contact-form-'+popupId+' .sgpb-field-textarea-wrapper textarea').first().val();var phoneValue=jQuery('.sgpb-contact-form-'+popupId+' .sgpb-field-phone-wrapper input').first().val();var advancedPhoneCountryCode=jQuery('.sgpb-contact-form-'+popupId+' .sgpb-field-advancedphone-wrapper select').first().val();var advancedPhoneValue=jQuery('.sgpb-contact-form-'+popupId+' .sgpb-field-advancedphone-wrapper input').first().val();var that=this.that;if(firstNameInput.length){firstNameValue=firstNameInput.val();}
if(firstNameInput.length){subjectValue=subjectInput.val();}
var data={action:'sgpb_contact_submission',nonce:SGPB_JS_PARAMS.nonce,beforeSend:function(){submitButton.prop('disabled',true);submitButton.val(submitButton.data('progress-title'));if(popupOptions['sgpb-contact-success-behavior']=='redirectToURL'&&popupOptions['sgpb-contact-success-redirect-new-tab']){that.newWindow=window.open(popupOptions['sgpb-contact-success-redirect-URL']);}},registerUser:popupOptions['sgpb-contact-register-user'],formData:formSerializedData,popupPostId:popupId,firstNameValue:firstNameValue,subjectValue:subjectValue,emailValue:emailValue,textareaValue:textareaValue,phoneValue:phoneValue,advancedPhoneValue:'(+'+advancedPhoneCountryCode+') '+advancedPhoneValue,};jQuery.post(SGPB_JS_PARAMS.ajaxUrl,data,function(res){jQuery('.sgpb-form-'+popupId+'-wrapper .contact-form-messages').addClass('sg-hide-element');that.submissionPopupId=popupId;submitButton.val(submitButton.data('title'));submitButton.prop('disabled',false);additionalPopupParams['res']=res;that.showMessages(additionalPopupParams,data);});};SGPBContactForm.prototype.showMessages=function(res)
{if(res['res']==1){this.submissionSuccessBehavior();window.dispatchEvent(new Event('resize'));return true;}
var popupId=parseInt(this.submissionPopupId);jQuery('.sgpb-form-'+popupId+'-wrapper .sgpb-alert-danger').removeClass('sg-hide-element');if(this.newWindow!=null){this.newWindow.close();}
return true;};SGPBContactForm.prototype.submissionSuccessBehavior=function()
{var settings={popupId:this.submissionPopupId,eventName:'sgpbContactSuccess'};jQuery(window).trigger('sgpbFormSuccess',settings);var popupId=parseInt(this.submissionPopupId);var popupOptions=SGPBPopup.getPopupOptionsById(popupId);var behavior='showMessage';jQuery('.sgpb-form-'+popupId+'-wrapper form').hide();if(typeof popupOptions['sgpb-contact-success-behavior']!='undefined'){behavior=popupOptions['sgpb-contact-success-behavior'];}
if(typeof popupOptions['sgpb-contact-hide-for-contacted-users']!='undefined'){this.setContactFormSubmissionCookie(popupId);}
this.resetFieldsValues();switch(behavior){case'showMessage':jQuery('.sgpb-form-'+popupId+'-wrapper .sgpb-alert-success').removeClass('sg-hide-element');break;case'redirectToURL':this.redirectToURL(popupOptions);break;case'openPopup':this.openSuccessPopup(popupOptions);break;case'hidePopup':SGPBPopup.closePopupById(this.submissionPopupId);break;}};SGPBContactForm.prototype.setContactFormSubmissionCookie=function(popupId)
{var currentUrl=window.location.href;var cookieName=SGPBContactForm.cookieName+popupId;var expiryTime=this.expiryTime;if(SGPopup.getCookie(cookieName)==''){var cookieObject=[currentUrl];SGPBPopup.setCookie(cookieName,JSON.stringify(cookieObject),expiryTime);}};SGPBContactForm.prototype.openPopup=function(popupOptions)
{if(typeof popupOptions['sgpb-contact-success-popup']=='undefined'){return false;}
var subPopupId=parseInt(popupOptions['sgpb-contact-success-popup']);var subPopupOptions=SGPBPopup.getPopupOptionsById(subPopupId);var popupObj=new SGPBPopup();popupObj.setPopupId(subPopupId);popupObj.setPopupData(subPopupOptions);setTimeout(function(){popupObj.prepareOpen();},500);};SGPBContactForm.prototype.redirectToURL=function(popupOptions)
{var redirectURL=popupOptions['sgpb-contact-success-redirect-URL'];var redirectToNewTab=popupOptions['sgpb-contact-success-redirect-new-tab'];SGPBPopup.closePopupById(this.submissionPopupId);if(redirectToNewTab){return true;}
window.location.href=redirectURL;};SGPBContactForm.prototype.openSuccessPopup=function(popupOptions)
{var that=this;setTimeout(function(){SGPBPopup.closePopupById(that.submissionPopupId);},0);if(typeof popupOptions['sgpb-contact-success-popup']!='undefined'){sgAddEvent(window,'sgpbDidClose',this.openPopup(popupOptions));}};SGPBContactForm.prototype.allowToOpen=function(popupId)
{var allowStatus=true;var cookieName=SGPBContactForm.cookieName+popupId;if(SGPopup.getCookie(cookieName)!=''){allowStatus=false;}
return allowStatus;};SGPBContactForm.prototype.resetFieldsValues=function()
{if(!jQuery('.js-contact-field-input').length){return false;}
jQuery('.js-contact-field-input').each(function(){jQuery(this).val('');});jQuery('.js-contact-field-message').val('');};SGPBContactForm.prototype.messageResize=function()
{if(!jQuery('.sgpb-contact-message-resize').length){return false;}
jQuery('.sgpb-contact-message-resize').change(function(){var val=jQuery(this).val();jQuery('.js-contact-field-message, .js-contact-field-textarea').css({'resize':val});});};SGPBContactForm.prototype.binding=function()
{var that=this;jQuery('.js-checkbox-field-status').bind('click',function(){var isChecked=jQuery(this).is(':checked');var fieldKey=jQuery(this).attr('data-field');var elementClassName='js-sgpb-form-field-'+fieldKey+'-wrapper';var element=jQuery('.'+elementClassName);that.toggleVisible(element,isChecked);});};SGPBContactForm.prototype.toggleVisible=function(toggleElement,elementStatus)
{if(elementStatus){toggleElement.css({'display':'block'});}
else{toggleElement.css({'display':'none'});}};SGPBContactForm.prototype.changePadding=function()
{jQuery('.js-sgpb-form-padding').on('change keydown keyup',function(){var padding=jQuery(this).val();jQuery('.sgpb-contact-admin-wrapper').css('padding',padding+'px');});};SGPBContactForm.prototype.changeLabels=function()
{jQuery('#sgpb-contact-gdpr-text').on('keyup',function(){var text=jQuery(this).val();jQuery(this).text('');jQuery(this).text(text);jQuery('.sgpb-gdpr-text-js').text(text);});jQuery('.js-contact-field-placeholder').each(function(){jQuery(this).bind('input',function(){var rel=jQuery(this).attr('data-field');var className='js-contact-'+rel;var placeholderText=jQuery(this).val();if(className=='js-contact-gdpr-label'){jQuery('.'+className).next().text(placeholderText);}
else{jQuery('.'+className).attr('placeholder',placeholderText);}});});};SGPBContactForm.prototype.changeButtonTitle=function()
{jQuery('.js-contact-submit-title').bind('input',function(){var val=jQuery(this).val();jQuery('.js-contact-field-submit').val(val);});};SGPBContactForm.prototype.changeOpacity=function()
{var that=this;jQuery('#js-contact-bg-opacity').prev().find('.range-handle').on('change mousemove',function(){SGPBContactFormBuilder.prototype.colorPickerChange(jQuery('input[name=sgpb-contact-form-bg-color]'));});SGPBContactFormBuilder.prototype.colorPickerChange(jQuery('input[name=sgpb-contact-form-bg-color]'));};SGPBContactForm.prototype.setupPlaceholderColor=function(element,color)
{jQuery('.'+element).each(function(){jQuery('.'+element+'-placeholder-color').remove();var styleContent='.'+element+'::-webkit-input-placeholder {color: '+color+' !important;}';styleContent+='.'+element+'::-moz-placeholder {color: '+color+' !important;}';styleContent+='.'+element+'::-ms-placeholder {color: '+color+' !important;}';var styleBlock='<style class="'+element+'-placeholder-color">'+styleContent+'</style>';jQuery('head').append(styleBlock);});};SGPBContactForm.prototype.changeDimension=function()
{if(!jQuery('.js-contact-dimension').length){return false;}
var that=this;jQuery('.js-contact-dimension').change(function(){var element=jQuery(this);var dimension=that.getCSSSafeSize(element.val());var styleType=element.attr('data-style-type');var field=element.attr('data-field-type');var selector='js-contact-field-'+field;if(field=='input'){jQuery('.sgpb-gdpr-label-wrapper').css('width',dimension);jQuery('.sgpb-gdpr-info').css('width',dimension);}
var styleObj={};styleObj[styleType]=dimension;if(!jQuery('.'+selector).length){return false;}
jQuery('.'+selector).each(function(){jQuery(this).css(styleObj);});});};SGPBContactForm.prototype.getCSSSafeSize=function(dimension)
{var size;size=parseInt(dimension)+'px';if(dimension.indexOf('%')!=-1||dimension.indexOf('px')!=-1){size=dimension;}
return size;};SGPBContactForm.prototype.preventDefaultSubmission=function()
{var formSubmitButton=jQuery('.sgpb-contact-admin-wrapper input[type="submit"]');if(!formSubmitButton.length){return false;}
formSubmitButton.bind('click',function(e){e.preventDefault();});};SGPBContactForm.prototype.makeContactTitleFieldsRequired=function()
{if(jQuery('.contact-redirect-to-URL').length){jQuery('input[name=sgpb-contact-success-behavior]').on('change',function(){if(jQuery('.contact-redirect-to-URL').is(':checked')){jQuery('#sgpb-contact-success-redirect-URL').attr('required','required');}
else{jQuery('#sgpb-contact-success-redirect-URL').removeAttr('required');}});}};jQuery(document).ready(function(){var contactObj=new SGPBContactForm();});